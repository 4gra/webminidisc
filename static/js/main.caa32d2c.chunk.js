(this.webpackJsonpwebmd=this.webpackJsonpwebmd||[]).push([[0],{162:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(255),o=n(65);t.DevicesIds=[{vendorId:1245,deviceId:29186,name:"Sharp IM-MT899H"},{vendorId:1356,deviceId:117,name:"Sony MZ-N1"},{vendorId:1356,deviceId:128,name:"Sony LAM-1"},{vendorId:1356,deviceId:129,name:"Sony MDS-JB980"},{vendorId:1356,deviceId:132,name:"Sony MZ-N505"},{vendorId:1356,deviceId:133,name:"Sony MZ-S1"},{vendorId:1356,deviceId:134,name:"Sony MZ-N707"},{vendorId:1356,deviceId:198,name:"Sony MZ-N10"},{vendorId:1356,deviceId:199,name:"Sony MZ-N910"},{vendorId:1356,deviceId:200,name:"Sony MZ-N710/NF810"},{vendorId:1356,deviceId:201,name:"Sony MZ-N510/N610"},{vendorId:1356,deviceId:202,name:"Sony MZ-NE410/NF520D"},{vendorId:1356,deviceId:235,name:"Sony MZ-NE810/NE910"},{vendorId:1356,deviceId:257,name:"Sony LAM-10"},{vendorId:1356,deviceId:275,name:"Aiwa AM-NX1"},{vendorId:1356,deviceId:332,name:"Aiwa AM-NX9"},{vendorId:1356,deviceId:382,name:"Sony MZ-NH1"},{vendorId:1356,deviceId:384,name:"Sony MZ-NH3D"},{vendorId:1356,deviceId:386,name:"Sony MZ-NH900"},{vendorId:1356,deviceId:388,name:"Sony MZ-NH700/NH800"},{vendorId:1356,deviceId:390,name:"Sony MZ-NH600/NH600D"},{vendorId:1356,deviceId:392,name:"Sony MZ-N920"},{vendorId:1356,deviceId:394,name:"Sony LAM-3"},{vendorId:1356,deviceId:489,name:"Sony MZ-DH10P"},{vendorId:1356,deviceId:537,name:"Sony MZ-RH10"},{vendorId:1356,deviceId:539,name:"Sony MZ-RH710/MZ-RH910"},{vendorId:1356,deviceId:556,name:"Sony CMT-AH10"},{vendorId:1356,deviceId:572,name:"Sony DS-HMD1"},{vendorId:1356,deviceId:646,name:"Sony MZ-RH1"}];var c=function(){function e(e,t,n){var r;void 0===t&&(t=0),this.device=e,this.iface=t,this.logger=n,this.logger=null===(r=n)||void 0===r?void 0:r.child({class:"NetMD"})}return e.prototype.init=function(){var e,t;return r(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return null===(e=this.logger)||void 0===e||e.debug("Init"),this.device.opened?[3,2]:(null===(t=this.logger)||void 0===t||t.debug("Opening device"),[4,this.device.open()]);case 1:n.sent(),n.label=2;case 2:return[4,this.device.selectConfiguration(1)];case 3:return n.sent(),[4,this.device.claimInterface(this.iface)];case 4:return n.sent(),[4,this.getReplyLength()];case 5:return n.sent()>0?[4,this.readReply()]:[3,7];case 6:n.sent(),n.label=7;case 7:return[2]}}))}))},e.prototype.getDeviceName=function(){var e,n,r=this.device,a=r.vendorId,i=r.productId;return null!==(n=null===(e=t.DevicesIds.find((function(e){return e.deviceId===i&&e.vendorId===a})))||void 0===e?void 0:e.name)&&void 0!==n?n:"Unknown Device"},e.prototype.finalize=function(){var e,t;return r(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:null===(e=this.logger)||void 0===e||e.debug("Finalize"),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.device.reset()];case 2:return r.sent(),[4,this.device.releaseInterface(this.iface)];case 3:return r.sent(),[4,this.device.close()];case 4:return r.sent(),[3,6];case 5:return n=r.sent(),null===(t=this.logger)||void 0===t||t.error({err:n}),[3,6];case 6:return[2]}}))}))},e.prototype.getReplyLength=function(){var e,t,n;return r(this,void 0,void 0,(function(){var r,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.device.controlTransferIn({requestType:"vendor",recipient:"interface",request:1,value:0,index:0},4)];case 1:return r=a.sent(),t=null===(e=r.data)||void 0===e?void 0:e.getUint8(2),o=null!==t&&void 0!==t?t:0,null===(n=this.logger)||void 0===n||n.debug({action:"getReplyLength",result:i.inspect(r),len:o}),[2,o]}}))}))},e.prototype.sendCommand=function(e){var t;return r(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return null===(t=this.logger)||void 0===t||t.debug({action:"sendCommand",command:i.inspect(e)}),[4,this.device.controlTransferOut({requestType:"vendor",recipient:"interface",request:128,value:0,index:0},e)];case 1:return n.sent(),[2]}}))}))},e.prototype.readReply=function(){var t;return r(this,void 0,void 0,(function(){var n,r,c;return a(this,(function(a){switch(a.label){case 0:return[4,this.getReplyLength()];case 1:n=a.sent(),r=0,a.label=2;case 2:return 0!==n?[3,5]:[4,o.sleep(e.readReplyRetryIntervalInMsec*Math.pow(2,~~(r/10)))];case 3:return a.sent(),[4,this.getReplyLength()];case 4:return n=a.sent(),r++,[3,2];case 5:return[4,this.device.controlTransferIn({requestType:"vendor",recipient:"interface",request:129,value:0,index:0},n)];case 6:return c=a.sent(),null===(t=this.logger)||void 0===t||t.debug({action:"readReply",result:i.inspect(c)}),[2,c]}}))}))},e.prototype.readBulk=function(e){return r(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return[4,this.readBulkToArray(e)];case 1:return t=n.sent(),[2,new Uint8Array(t)]}}))}))},e.prototype.readBulkToArray=function(e,t){return void 0===t&&(t=65536),r(this,void 0,void 0,(function(){var t,n,r;return a(this,(function(a){switch(a.label){case 0:t=0,n=new ArrayBuffer(0),a.label=1;case 1:return t<e?[4,this.device.transferIn(this.iface,Math.min(e-t,e))]:[3,3];case 2:if(!(r=a.sent()).data)throw new Error("expected data");return t+=r.data.byteLength,n=o.concatArrayBuffers(n,r.data.buffer),[3,1];case 3:return[2,n]}}))}))},e.prototype.writeBulk=function(e){return r(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.device.transferOut(2,e)];case 1:return[2,t.sent()]}}))}))},e.readReplyRetryIntervalInMsec=10,e}();t.NetMD=c},163:function(e,t,n){"use strict";var r,a,i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"===typeof f?f(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,a){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,a,(t=e[n](t)).done,t.value)}))}}},u=this&&this.__await||function(e){return this instanceof u?(this.v=e,this):new u(e)},l=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),i=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){a[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||c(e,t)}))})}function c(e,t){try{(n=a[e](t)).value instanceof u?Promise.resolve(n.value.v).then(s,l):f(i[0][2],n)}catch(r){f(i[0][3],r)}var n}function s(e){c("next",e)}function l(e){c("throw",e)}function f(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}},f=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},d=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(c){a={error:c}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},p=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var v,m,y,b,g,w=n(258),k=n(65),x=h(n(164)),E=h(n(165));!function(e){e[e.control=0]="control",e[e.status=1]="status",e[e.specificInquiry=2]="specificInquiry",e[e.notify=3]="notify",e[e.generalInquiry=4]="generalInquiry",e[e.notImplemented=8]="notImplemented",e[e.accepted=9]="accepted",e[e.rejected=10]="rejected",e[e.inTransition=11]="inTransition",e[e.implemented=12]="implemented",e[e.changed=13]="changed",e[e.interim=15]="interim"}(v||(v={})),function(e){e[e.play=117]="play",e[e.pause=125]="pause",e[e.fastForward=57]="fastForward",e[e.rewind=73]="rewind"}(m||(m={})),function(e){e[e.previous=2]="previous",e[e.next=32769]="next",e[e.restart=1]="restart"}(y||(y={})),function(e){e[e.lp4=0]="lp4",e[e.lp2=2]="lp2",e[e.spMono=4]="spMono",e[e.spStereo=6]="spStereo"}(b=t.DiscFormat||(t.DiscFormat={})),function(e){e[e.pcm=0]="pcm",e[e.l105kbps=144]="l105kbps",e[e.lp2=148]="lp2",e[e.lp4=168]="lp4"}(g=t.Wireformat||(t.Wireformat={})),function(e){e[e.sp=144]="sp",e[e.lp2=146]="lp2",e[e.lp4=147]="lp4"}(t.Encoding||(t.Encoding={})),function(e){e[e.mono=1]="mono",e[e.stereo=0]="stereo"}(t.Channels||(t.Channels={})),function(e){e[e.mono=1]="mono",e[e.stereo=2]="stereo"}(t.ChannelCount||(t.ChannelCount={})),function(e){e[e.protected=3]="protected",e[e.unprotected=0]="unprotected"}(t.TrackFlag||(t.TrackFlag={})),function(e){e[e.writable=16]="writable",e[e.writeProtected=64]="writeProtected"}(t.DiscFlag||(t.DiscFlag={})),t.FrameSize=((r={})[g.pcm]=2048,r[g.lp2]=192,r[g.l105kbps]=152,r[g.lp4]=96,r);var S=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return i(t,e),t}(Error),C=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return i(t,e),t}(S),I=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return i(t,e),t}(S),O=function(){function e(e){this.netMd=e}return e.prototype.sendQuery=function(e,t){return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,this.sendCommand(e,t)];case 1:return n.sent(),[2,this.readReply()]}}))}))},e.prototype.sendCommand=function(e,t){return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var n;return c(this,(function(r){return n=t?new Uint8Array([v.specificInquiry]).buffer:new Uint8Array([v.control]).buffer,this.netMd.sendCommand(k.concatArrayBuffers(n,e)),[2]}))}))},e.prototype.readReply=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return[4,this.netMd.readReply()];case 1:if(void 0===(e=n.sent().data))throw new Error("unexpected undefined value in readReply");if((t=e.getUint8(0))===v.notImplemented)throw new C("Not implemented");if(t===v.rejected)throw new I("Rejected");if([v.accepted,v.implemented,v.interim].indexOf(t)<-1)throw new C("Unknown return status: "+t);return[2,e.buffer.slice(1)]}}))}))},e.prototype.acquire=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("ff 010c ffff ffff ffff ffff ffff ffff"),[4,this.sendQuery(e)];case 1:return t=n.sent(),w.scanQuery(t,"ff 010c ffff ffff ffff ffff ffff ffff"),[2]}}))}))},e.prototype.release=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("ff 0100 ffff ffff ffff ffff ffff ffff"),[4,this.sendQuery(e)];case 1:return t=n.sent(),w.scanQuery(t,"ff 0100 ffff ffff ffff ffff ffff ffff"),[2]}}))}))},e.prototype.getStatus=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1809 8001 0230 8800 0030 8804 00 ff00 00000000"),[4,this.sendQuery(e)];case 1:return t=n.sent(),[2,w.scanQuery(t,"1809 8001 0230 8800 0030 8804 00 1000 000900000 %x")[0]]}}))}))},e.prototype.isDiscPresent=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.getStatus()];case 1:return[2,64===e.sent().charCodeAt(4)]}}))}))},e.prototype.getOperatingStatus=function(){return o(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return e=w.formatQuery("1809 8001 0330 8802 0030 8805 0030 8806 00 ff00 00000000"),[4,this.sendQuery(e)];case 1:return t=r.sent(),n=w.scanQuery(t,"1809 8001 0330 8802 0030 8805 0030 8806 00 1000 00%?0000 0006 8806 0002 %w")[0],[2,x.default.toNumber(n)]}}))}))},e.prototype._getPlaybackStatus=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return c(this,(function(a){switch(a.label){case 0:return n=w.formatQuery("1809 8001 0330 %w 0030 8805 0030 %w 00 ff00 00000000",e,t),[4,this.sendQuery(n)];case 1:return r=a.sent(),[2,w.scanQuery(r,"1809 8001 0330 %?%? %?%? %?%? %?%? %?%? %? 1000 00%?0000 %x")[0]]}}))}))},e.prototype.getPlaybackStatus1=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){return[2,this._getPlaybackStatus(34817,34823)]}))}))},e.prototype.getPlaybackStatus2=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){return[2,this._getPlaybackStatus(34818,34822)]}))}))},e.prototype.getPosition=function(){return o(this,void 0,void 0,(function(){var e,t,n,r;return c(this,(function(a){switch(a.label){case 0:e=w.formatQuery("1809 8001 0430 8802 0030 8805 0030 0003 0030 0002 00 ff00 00000000"),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.sendQuery(e)];case 2:return t=a.sent(),[3,4];case 3:if((n=a.sent())instanceof I)return[2,null];throw n;case 4:return(r=w.scanQuery(t,"1809 8001 0430 %?%? %?%? %?%? %?%? %?%? %?%? %?%? %? %?00 00%?0000 000b 0002 0007 00 %w %b %b %b %b"))[0]=x.default.toNumber(r[0]),r[1]=w.BCD2int(x.default.toNumber(r[1])),r[2]=w.BCD2int(x.default.toNumber(r[2])),r[3]=w.BCD2int(x.default.toNumber(r[3])),r[4]=w.BCD2int(x.default.toNumber(r[4])),[2,r]}}))}))},e.prototype._play=function(e){return o(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return t=w.formatQuery("18c3 ff %b 000000",e),[4,this.sendQuery(t)];case 1:return n=r.sent(),w.scanQuery(n,"18c3 00 %b 000000"),[2]}}))}))},e.prototype.play=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this._play(m.play)];case 1:return e.sent(),[2]}}))}))},e.prototype.fast_forward=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this._play(m.fastForward)];case 1:return e.sent(),[2]}}))}))},e.prototype.rewind=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this._play(m.rewind)];case 1:return e.sent(),[2]}}))}))},e.prototype.pause=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this._play(m.pause)];case 1:return e.sent(),[2]}}))}))},e.prototype.stop=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("18c5 ff 00000000"),[4,this.sendQuery(e)];case 1:return t=n.sent(),w.scanQuery(t,"18c5 00 00000000"),[2]}}))}))},e.prototype.gotoTrack=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return c(this,(function(a){switch(a.label){case 0:return t=w.formatQuery("1850 ff010000 0000 %w",e),[4,this.sendQuery(t)];case 1:return n=a.sent(),r=w.scanQuery(n,"1850 00010000 0000 %w")[0],[2,x.default.toNumber(r)]}}))}))},e.prototype.gotoTime=function(e,t,n,r,a){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),o(this,void 0,void 0,(function(){var i,o;return c(this,(function(c){switch(c.label){case 0:return i=w.formatQuery("1850 ff000000 0000 %w %b%b%b%b",e,w.int2BCD(t),w.int2BCD(n),w.int2BCD(r),w.int2BCD(a)),[4,this.sendQuery(i)];case 1:return o=c.sent(),[2,w.scanQuery(o,"1850 00000000 %?%? %w %b%b%b%b").map((function(e){return x.default.toNumber(e)}))]}}))}))},e.prototype._trackChange=function(e){return o(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return t=w.formatQuery("1850 ff10 00000000 %w",e),[4,this.sendQuery(t)];case 1:return n=r.sent(),[2,w.scanQuery(n,"1850 0010 00000000 %?%?")]}}))}))},e.prototype.nextTrack=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this._trackChange(y.next)];case 1:return e.sent(),[2]}}))}))},e.prototype.previousTrack=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this._trackChange(y.previous)];case 1:return e.sent(),[2]}}))}))},e.prototype.restartTrack=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this._trackChange(y.restart)];case 1:return e.sent(),[2]}}))}))},e.prototype.eraseDisc=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1840 ff 0000"),[4,this.sendQuery(e)];case 1:return t=n.sent(),w.scanQuery(t,"1840 00 0000"),[2]}}))}))},e.prototype.syncTOC=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1808 10180200 00"),[4,this.sendQuery(e)];case 1:return t=n.sent(),w.scanQuery(t,"1808 10180200 00"),[2]}}))}))},e.prototype.cacheTOC=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1808 10180203 00"),[4,this.sendQuery(e)];case 1:return t=n.sent(),w.scanQuery(t,"1808 10180203 00"),[2]}}))}))},e.prototype.getDiscFlags=function(){return o(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return e=w.formatQuery("1806 01101000 ff00 0001000b"),[4,this.sendQuery(e)];case 1:return t=r.sent(),n=w.scanQuery(t,"1806 01101000 1000 0001000b %b"),[2,x.default.toNumber(n[0])]}}))}))},e.prototype.getTrackCount=function(){return o(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return e=w.formatQuery("1806 02101001 3000 1000 ff00 00000000"),[4,this.sendQuery(e)];case 1:return t=r.sent(),n=w.scanQuery(t,"1806 02101001 %?%? %?%? 1000 00%?0000 %x")[0],k.assert(6===n.length,"Expected length === 6 for data"),k.assert("\0\x10\0\x02\0"===n.substring(0,5),"Wrong header in data response"),[2,n.charCodeAt(5)]}}))}))},e.prototype._getDiscTitle=function(e){return void 0===e&&(e=!1),o(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u,l,f;return c(this,(function(c){switch(c.label){case 0:t=e?1:0,n=0,r=0,a=1,i=[],c.label=1;case 1:return n<a?(u=w.formatQuery("1806 02201801 00%b 3000 0a00 ff00 %w%w",t,r,n),[4,this.sendQuery(u)]):[3,3];case 2:return l=c.sent(),0===r?(f=w.scanQuery(l,"1806 02201801 00%? 3000 0a00 1000 %w0000 %?%?000a %w %*"),o=x.default.toNumber(f[0]),a=x.default.toNumber(f[1]),s=f[2],o-=6):(f=w.scanQuery(l,"1806 02201801 00%? 3000 0a00 1000 %w%?%? %*"),o=x.default.toNumber(f[0]),s=f[1]),k.assert(o===s.length),i.push(s),r=a-(n+=o),[3,1];case 3:return[2,i.join("")]}}))}))},e.prototype.getDiscTitle=function(e){return void 0===e&&(e=!1),o(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return[4,this._getDiscTitle(e)];case 1:return(t=r.sent()).endsWith("//")&&(n=t.split("//")[0],t=n.startsWith("0;")?n.substring(2):""),[2,t]}}))}))},e.prototype.getTrackGroupList=function(){return o(this,void 0,void 0,(function(){var e,t,n,r,a,i,o,s,u,l,h,v,m,y,b,g,w,x,E,S,C,I,O,T;return c(this,(function(c){switch(c.label){case 0:return[4,this._getDiscTitle()];case 1:return e=c.sent(),t=e.split("//"),n={},[4,this.getTrackCount()];case 2:r=c.sent(),a=[];try{for(i=f(t.entries()),o=i.next();!o.done;o=i.next())if(s=d(o.value,2),u=s[0],""!==(l=s[1])&&"0"!==l[0]&&-1!==l.indexOf(";")){for(h=d(l.split(";",2),2),v=h[0],m=h[1],y=void 0,b=void 0,v.indexOf("-")>=0?(T=d(v.split("-"),2),y=T[0],b=T[1]):y=b=v,g=d([Number.parseInt(y,10),Number.parseInt(b,10)],2),w=g[0],x=g[1],k.assert(0<=w),k.assert(w<=x),k.assert(x<=r),E=[],S=w-1;S<x;S++){if(S in n)throw new Error("Track "+S+" is in 2 groups: "+n[S][0]);n[S]=[m,u],E.push(S)}a.push([m,E])}}catch(D){I={error:D}}finally{try{o&&!o.done&&(O=i.return)&&O.call(i)}finally{if(I)throw I.error}}return(C=p(Array(r).keys()).filter((function(e){return!(e in n)}))).length>0&&a.push([null,C]),[2,a]}}))}))},e.prototype.getTrackTitle=function(e,t){return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var n,r,a;return c(this,(function(i){switch(i.label){case 0:return n=t?3:2,r=w.formatQuery("1806 022018%b %w 3000 0a00 ff00 00000000",n,e),[4,this.sendQuery(r)];case 1:return a=i.sent(),[2,w.scanQuery(a,"1806 022018%? %?%? %?%? %?%? 1000 00%?0000 00%?000a %x")[0]]}}))}))},e.prototype.setDiscTitle=function(e,t){return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var n,r,a,i;return c(this,(function(o){switch(o.label){case 0:return n=t?1:0,[4,this.getDiscTitle()];case 1:return r=o.sent().length,a=w.formatQuery("1807 02201801 00%b 3000 0a00 5000 %w 0000 %w %*",n,e.length,r,e),[4,this.sendQuery(a)];case 2:return i=o.sent(),w.scanQuery(i,"1807 02201801 00%? 3000 0a00 5000 %?%? 0000 %?%?"),[2]}}))}))},e.prototype.setTrackTitle=function(e,t,n){return void 0===n&&(n=!1),o(this,void 0,void 0,(function(){var r,a,i,o,s;return c(this,(function(c){switch(c.label){case 0:r=n?3:2,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.getTrackTitle(e)];case 2:return a=c.sent().length,[3,4];case 3:if(!((i=c.sent())instanceof I))throw i;return a=0,[3,4];case 4:return o=w.formatQuery("1807 022018%b %w 3000 0a00 5000 %w 0000 %w %*",r,e,t.length,a,t),[4,this.sendQuery(o)];case 5:return s=c.sent(),w.scanQuery(s,"1807 022018%? %?%? 3000 0a00 5000 %?%? 0000 %?%?"),[2]}}))}))},e.prototype.eraseTrack=function(e){return o(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return t=w.formatQuery("1840 ff01 00 201001 %w",e),[4,this.sendQuery(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.moveTrack=function(e,t){return o(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return n=w.formatQuery("1843 ff00 00 201001 %w 201001 %w",e,t),[4,this.sendQuery(n)];case 1:return r.sent(),[2]}}))}))},e.prototype._getTrackInfo=function(e,t,n){return o(this,void 0,void 0,(function(){var r,a;return c(this,(function(i){switch(i.label){case 0:return r=w.formatQuery("1806 02201001 %w %w %w ff00 00000000",e,t,n),[4,this.sendQuery(r)];case 1:return a=i.sent(),[2,w.scanQuery(a,"1806 02201001 %?%? %?%? %?%? 1000 00%?0000 %x")[0]]}}))}))},e.prototype.getTrackLength=function(e){return o(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return[4,this._getTrackInfo(e,12288,256)];case 1:return t=r.sent(),(n=w.scanQuery(k.stringToCharCodeArray(t),"0001 0006 0000 %b %b %b %b"))[0]=w.BCD2int(x.default.toNumber(n[0])),n[1]=w.BCD2int(x.default.toNumber(n[1])),n[2]=w.BCD2int(x.default.toNumber(n[2])),n[3]=w.BCD2int(x.default.toNumber(n[3])),[2,n]}}))}))},e.prototype.getTrackEncoding=function(e){return o(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return[4,this._getTrackInfo(e,12416,1792)];case 1:return t=n.sent(),[2,w.scanQuery(k.stringToCharCodeArray(t),"8007 0004 0110 %b %b").map((function(e){return x.default.toNumber(e)}))]}}))}))},e.prototype.getTrackFlags=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return c(this,(function(a){switch(a.label){case 0:return t=w.formatQuery("1806 01201001 %w ff00 00010008",e),[4,this.sendQuery(t)];case 1:return n=a.sent(),r=w.scanQuery(n,"1806 01201001 %?%? 10 00 00010008 %b")[0],[2,x.default.toNumber(r)]}}))}))},e.prototype.getDiscCapacity=function(){return o(this,void 0,void 0,(function(){var e,t,n,r,a,i,o;return c(this,(function(c){switch(c.label){case 0:return e=w.formatQuery("1806 02101000 3080 0300 ff00 00000000"),[4,this.sendQuery(e)];case 1:for(t=c.sent(),n=[],r=w.scanQuery(t,"1806 02101000 3080 0300 1000 001d0000 001b 8003 0017 8000 0005 %w %b %b %b 0005 %w %b %b %b 0005 %w %b %b %b"),a=0;a<3;a++)i=4*a,o=[w.BCD2int(x.default.toNumber(r[i+0])),w.BCD2int(x.default.toNumber(r[i+1])),w.BCD2int(x.default.toNumber(r[i+2])),w.BCD2int(x.default.toNumber(r[i+3]))],n.push(o);return[2,n]}}))}))},e.prototype.getRecordingParameters=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1809 8001 0330 8801 0030 8805 0030 8807 00 ff00 00000000"),[4,this.sendQuery(e)];case 1:return t=n.sent(),[2,w.scanQuery(t,"1809 8001 0330 8801 0030 8805 0030 8807 00 1000 000e0000 000c 8805 0008 80e0 0110 %b %b 4000").map((function(e){return x.default.toNumber(e)}))]}}))}))},e.prototype.disableNewTrackProtection=function(e){return o(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return t=w.formatQuery("1800 080046 f0030103 2b ff %w",e),[4,this.sendQuery(t)];case 1:return n=r.sent(),w.scanQuery(n,"1800 080046 f0030103 2b 00 %?%?"),[2]}}))}))},e.prototype.enterSecureSession=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1800 080046 f0030103 80 ff"),[4,this.sendQuery(e)];case 1:return t=n.sent(),[2,w.scanQuery(t,"1800 080046 f0030103 80 00")]}}))}))},e.prototype.leaveSecureSession=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1800 080046 f0030103 81 ff"),[4,this.sendQuery(e)];case 1:return t=n.sent(),[2,w.scanQuery(t,"1800 080046 f0030103 81 00")]}}))}))},e.prototype.getLeafID=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1800 080046 f0030103 11 ff"),[4,this.sendQuery(e)];case 1:return t=n.sent(),[2,w.scanQuery(t,"1800 080046 f0030103 11 00 %*")[0]]}}))}))},e.prototype.sendKeyData=function(e,t,n,r){return o(this,void 0,void 0,(function(){var a,i,o,s,u,l,d,h,v,m;return c(this,(function(c){switch(c.label){case 0:a=t.length,i=16+16*a+24;try{for(o=f(t),s=o.next();!s.done;s=o.next())if(16!==(u=s.value).length)throw new Error("Each key in the chain needs to have 16 bytes; this one has "+u.length)}catch(y){v={error:y}}finally{try{s&&!s.done&&(m=o.return)&&m.call(o)}finally{if(v)throw v.error}}if(n<1||n>63)throw new Error("Supplied depth is invalid");if(24!==r.length)throw new Error("Supplied EKB signature length wrong");return l=k.concatUint8Arrays.apply(void 0,p(t)),d=w.formatQuery("1800 080046 f0030103 12 ff %w %d %d %d %d 00000000 %* %*",i,i,a,n,e,l,r),[4,this.sendQuery(d)];case 1:return h=c.sent(),[2,w.scanQuery(h,"1800 080046 f0030103 12 01 %?%? %?%?%?%?")]}}))}))},e.prototype.sessionKeyExchange=function(e){return o(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:if(8!==e.length)throw new Error("Supplied host nonce length wrong");return t=w.formatQuery("1800 080046 f0030103 20 ff 000000 %*",e),[4,this.sendQuery(t)];case 1:return n=r.sent(),[2,w.scanQuery(n,"1800 080046 f0030103 20 00 000000 %#")[0]]}}))}))},e.prototype.sessionKeyForget=function(){return o(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return e=w.formatQuery("1800 080046 f0030103 21 ff 000000"),[4,this.sendQuery(e)];case 1:return t=n.sent(),[2,w.scanQuery(t,"1800 080046 f0030103 21 00 000000")]}}))}))},e.prototype.setupDownload=function(e,t,n){return o(this,void 0,void 0,(function(){var r,a,i,o;return c(this,(function(c){switch(c.label){case 0:if(20!==e.length)throw new Error("Supplied Content ID length wrong");if(8!==t.length)throw new Error("Supplied Key Encryption Key length wrong");if(16!==n.length)throw new Error("Supplied Session Key length wrong");return r=k.concatUint8Arrays(new Uint8Array([1,1,1,1]),e,t),a=E.default.DES.encrypt(E.default.lib.WordArray.create(r),E.default.enc.Hex.parse(n),{mode:E.default.mode.CBC,iv:E.default.enc.Hex.parse("0000000000000000")}),i=w.formatQuery("1800 080046 f0030103 22 ff 0000 %*",k.wordArrayToByteArray(a.ciphertext)),[4,this.sendQuery(i)];case 1:return o=c.sent(),[2,w.scanQuery(o,"1800 080046 f0030103 22 00 0000")]}}))}))},e.prototype.commitTrack=function(e,t){return o(this,void 0,void 0,(function(){var n,r,a;return c(this,(function(i){switch(i.label){case 0:if(16!==t.length)throw new Error("Supplied Session Key length wrong");return n=E.default.DES.encrypt(E.default.enc.Hex.parse("0000000000000000"),E.default.enc.Hex.parse(t),{mode:E.default.mode.ECB}),r=w.formatQuery("1800 080046 f0030103 48 ff 00 1001 %w %*",e,k.wordArrayToByteArray(n.ciphertext)),[4,this.sendQuery(r)];case 1:return a=i.sent(),[2,w.scanQuery(a,"1800 080046 f0030103 48 00 00 1001 %?%?")]}}))}))},e.prototype.sendTrack=function(e,t,n,r,a,i,u){var l,f,d,p;return o(this,void 0,void 0,(function(){var o,h,v,m,y,b,g,S,C,I,O,T,D,j,A;return c(this,(function(c){switch(c.label){case 0:if(16!==i.length)throw new Error("Supplied Session Key length wrong");return o=r+24,h=w.formatQuery("1800 080046 f0030103 28 ff 000100 1001 ffff 00 %b %b %d %d",e,t,n,o),[4,this.sendQuery(h)];case 1:v=c.sent(),w.scanQuery(v,"1800 080046 f0030103 28 00 000100 1001 %?%? 00 %*"),m=!k.isBigEndian(),y=0,b=0,c.label=2;case 2:c.trys.push([2,8,9,14]),l=s(a),c.label=3;case 3:return[4,l.next()];case 4:return(f=c.sent()).done?[3,7]:(g=f.value,S=g.key,C=g.iv,I=g.data,u&&u({totalBytes:o,writtenBytes:b}),O=void 0,0===y?(T=new Uint8Array(new Uint32Array([r]).buffer),m&&T.reverse(),O=k.concatUint8Arrays(new Uint8Array([0,0,0,0]),T,S,C,I)):O=I,[4,this.netMd.writeBulk(O)]);case 5:c.sent(),y+=1,b+=I.length,c.label=6;case 6:return[3,3];case 7:return[3,14];case 8:return D=c.sent(),d={error:D},[3,14];case 9:return c.trys.push([9,,12,13]),f&&!f.done&&(p=l.return)?[4,p.call(l)]:[3,11];case 10:c.sent(),c.label=11;case 11:return[3,13];case 12:if(d)throw d.error;return[7];case 13:return[7];case 14:return u&&u({totalBytes:o,writtenBytes:b}),[4,this.readReply()];case 15:return v=c.sent(),[4,this.netMd.getReplyLength()];case 16:return c.sent(),j=w.scanQuery(v,"1800 080046 f0030103 28 00 000100 1001 %w 00 %?%? %?%?%?%? %?%?%?%? %*"),A=E.default.DES.decrypt(E.default.enc.Hex.parse(k.hexEncode(j[1])),E.default.enc.Hex.parse(i),{mode:E.default.mode.CBC,iv:E.default.enc.Hex.parse("0000000000000000")}).toString(E.default.enc.Utf8),[2,[x.default.toNumber(j[0]),A.substring(0,8),A.substring(12,32)]]}}))}))},e.prototype.getTrackUUID=function(e){return o(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return t=w.formatQuery("1800 080046 f0030103 23 ff 1001 %w",e),[4,this.sendQuery(t)];case 1:return n=r.sent(),[2,w.scanQuery(n,"1800 080046 f0030103 23 00 1001 %?%? %*")[0]]}}))}))},e}();function T(e,t,n){void 0===n&&(n=new Uint8Array([0,0,0,0,0,0,0,0]));var r=e.subarray(0,8),a=t.subarray(0,t.length-8),i=t.subarray(t.length-8,t.length),o=E.default.DES.encrypt(E.default.lib.WordArray.create(a),E.default.lib.WordArray.create(r),{mode:E.default.mode.CBC,iv:E.default.lib.WordArray.create(n)}),c=E.default.enc.Hex.stringify(o.ciphertext);c=c.substring(0,c.length-16);var s=E.default.TripleDES.encrypt(E.default.lib.WordArray.create(i),E.default.lib.WordArray.create(e),{mode:E.default.mode.CBC,iv:E.default.enc.Hex.parse(c)});return E.default.enc.Hex.stringify(s.ciphertext).substring(0,16)}t.NetMDInterface=O,t.retailmac=T;var D=((a={})[g.pcm]=b.spStereo,a[g.lp2]=b.lp2,a[g.l105kbps]=b.lp2,a[g.lp4]=b.lp4,a),j=function(){function e(){}return e.prototype.getRootKey=function(){return new Uint8Array([18,52,86,120,154,188,222,240,15,237,203,169,135,101,67,33])},e.prototype.getEKBID=function(){return 641869378},e.prototype.getEKBDataForLeafId=function(){return[[new Uint8Array([37,69,6,77,234,202,20,249,150,189,200,164,6,194,43,129]),new Uint8Array([251,96,189,221,13,188,171,132,138,0,94,3,25,77,62,218])],9,new Uint8Array([143,43,195,82,232,108,94,211,6,220,174,24,210,243,140,127,137,181,225,133,85,161,5,234])]},e}();t.EKBOpenSource=j;var A=function(){function e(e,t,n,r,a){this.title=e,this.format=t,this.data=n,this.chunkSize=r,this.encryptPacketsIterator=a}return e.prototype.getTitle=function(){return this.title},e.prototype.getDataFormat=function(){return this.format},e.prototype.getFrameCount=function(){return this.getTotalSize()/this.getFrameSize()},e.prototype.getFrameSize=function(){return t.FrameSize[this.format]},e.prototype.getChunkSize=function(){return this.chunkSize},e.prototype.getTotalSize=function(){var e=this.getFrameSize(),t=this.data.byteLength;return t%e!==0&&(t+=e-t%e),t},e.prototype.getContentID=function(){return new Uint8Array([1,15,80,0,0,4,0,0,0,72,162,141,62,26,59,12,68,175,47,160])},e.prototype.getKEK=function(){return new Uint8Array([20,227,131,78,226,211,204,165])},e.prototype.getPackets=function(){var e=new Uint8Array([0,0,0,0,0,0,0,0]),t=new Uint8Array([0,0,0,0,0,0,0,0]),n=E.default.lib.WordArray.create(e),r=E.default.lib.WordArray.create(this.getKEK()),a=E.default.DES.encrypt(n,r,{mode:E.default.mode.ECB}),i=E.default.lib.WordArray.create(t),o=E.default.lib.WordArray.create(this.data),c=E.default.DES.encrypt(o,a.ciphertext,{mode:E.default.mode.CBC,iv:i}),s=k.wordArrayToByteArray(c.ciphertext);return[[e,t,s=s.subarray(0,this.data.byteLength)]]},e.prototype.getPacketWorkerIterator=function(){return this.encryptPacketsIterator({kek:this.getKEK(),data:this.data,frameSize:this.getFrameSize(),chunkSize:this.chunkSize})},e.prototype.getPacketIterator=function(){return l(this,arguments,(function(){var e,t,n,r,a,i,o,s,l,f,d,p,h,v,m,y,b;return c(this,(function(c){switch(c.label){case 0:e=new Uint8Array([0,0,0,0,0,0,0,0]),t=E.default.lib.WordArray.create(e),n=E.default.lib.WordArray.create(this.getKEK()),r=E.default.lib.WordArray.random(8),(a=E.default.DES.decrypt({ciphertext:r},n,{mode:E.default.mode.ECB,padding:E.default.pad.Pkcs7})).sigBytes=8,i=k.wordArrayToByteArray(a),o=1048576,s=0,l=0,f=new Uint8Array(this.data),d=this.getFrameSize(),f.length%d!==0&&(p=d-f.length%d,f=k.concatUint8Arrays(f,new Uint8Array(Array(p).fill(0)))),h=0,c.label=1;case 1:return h<f.length?(l=s>0?o:o-24,l=Math.min(l,f.length-h),v=f.subarray(h,h+l),m=E.default.lib.WordArray.create(v),y=E.default.DES.encrypt(m,r,{mode:E.default.mode.CBC,iv:t}),b=(b=k.wordArrayToByteArray(y.ciphertext)).subarray(0,l),[4,u([i,e,b])]):[3,4];case 2:return[4,c.sent()];case 3:return c.sent(),t=E.default.lib.WordArray.create(b.subarray(b.length-8,b.length)),e=k.wordArrayToByteArray(t),h+=l,s+=1,[3,1];case 4:return[2]}}))}))},e}();t.MDTrack=A;var N=function(){function e(e,t,n){this.md=e,this.ekbobject=t,this.hexSessionKey=n}return e.prototype.init=function(){return o(this,void 0,void 0,(function(){var e,t,n,r,a,i,o;return c(this,(function(c){switch(c.label){case 0:return[4,this.md.enterSecureSession()];case 1:return c.sent(),e=d(this.ekbobject.getEKBDataForLeafId(),3),t=e[0],n=e[1],r=e[2],[4,this.md.sendKeyData(x.default.BigInt(this.ekbobject.getEKBID()),t,n,r)];case 2:return c.sent(),a=new Uint8Array(Array(8).fill(0).map((function(e){return Math.round(255*Math.random())}))),[4,this.md.sessionKeyExchange(a)];case 3:return i=c.sent(),o=k.concatUint8Arrays(a,i),this.hexSessionKey=T(this.ekbobject.getRootKey(),o),[2]}}))}))},e.prototype.downloadTrack=function(e,t){return o(this,void 0,void 0,(function(){var n,r,a,i,o;return c(this,(function(c){switch(c.label){case 0:if(!this.hexSessionKey)throw new Error("Call init first!");return[4,this.md.setupDownload(e.getContentID(),e.getKEK(),this.hexSessionKey)];case 1:return c.sent(),n=e.getDataFormat(),[4,this.md.sendTrack(n,D[n],e.getFrameCount(),e.getTotalSize(),e.getPacketWorkerIterator(),this.hexSessionKey,t)];case 2:return r=d.apply(void 0,[c.sent(),3]),a=r[0],i=r[1],o=r[2],[4,this.md.cacheTOC()];case 3:return c.sent(),[4,this.md.setTrackTitle(a,e.title)];case 4:return c.sent(),[4,this.md.syncTOC()];case 5:return c.sent(),[4,this.md.commitTrack(a,this.hexSessionKey)];case 6:return c.sent(),[2,[a,i,o]]}}))}))},e.prototype.close=function(){return o(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:if(void 0===this.hexSessionKey)return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.md.sessionKeyForget()];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:this.hexSessionKey=void 0,e.label=5;case 5:return[4,this.md.leaveSecureSession()];case 6:return e.sent(),[2]}}))}))},e}();t.MDSession=N},20:function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(162)),r(n(163)),r(n(363)),r(n(205));var a=n(65);t.formatTimeFromFrames=a.formatTimeFromFrames},205:function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},a=this&&this.__await||function(e){return this instanceof a?(this.v=e,this):new a(e)},i=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},c("next"),c("throw"),c("return"),r[Symbol.asyncIterator]=function(){return this},r;function c(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof a?Promise.resolve(n.value.v).then(u,l):f(o[0][2],n)}catch(r){f(o[0][3],r)}var n}function u(e){s("next",e)}function l(e){s("throw",e)}function f(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(165)),s=n(65);t.getAsyncPacketIterator=function(e){var t=e.data,n=e.frameSize,o=e.kek,u=e.chunkSize;return i(this,arguments,(function(){var e,i,l,f,d,p,h,v,m,y,b,g,w,k,x,E,S,C;return r(this,(function(r){switch(r.label){case 0:e=new Uint8Array([0,0,0,0,0,0,0,0]),i=c.default.lib.WordArray.create(e),l=c.default.lib.WordArray.create(o),f=c.default.lib.WordArray.random(8),(d=c.default.DES.decrypt({ciphertext:f},l,{mode:c.default.mode.ECB,padding:c.default.pad.Pkcs7})).sigBytes=8,p=s.wordArrayToByteArray(d),h=u||1048576,v=0,m=0,(y=new Uint8Array(t)).length%n!==0&&(b=n-y.length%n,y=s.concatUint8Arrays(y,new Uint8Array(Array(b).fill(0)))),g=0,r.label=1;case 1:return g<y.length?(m=v>0?h:h-24,m=Math.min(m,y.length-g),w=y.subarray(g,g+m),k=c.default.lib.WordArray.create(w),x=c.default.DES.encrypt(k,f,{mode:c.default.mode.CBC,iv:i}),E=(E=s.wordArrayToByteArray(x.ciphertext)).subarray(0,m),S=c.default.lib.WordArray.create(E.subarray(E.length-8,E.length)),C=s.wordArrayToByteArray(i),[4,a({key:p,iv:e,data:E})]):[3,4];case 2:return[4,r.sent()];case 3:return r.sent(),i=S,e=C,g+=m,v+=1,[3,1];case 4:return[2]}}))}))}},212:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},i=this&&this.__await||function(e){return this instanceof i?(this.v=e,this):new i(e)},o=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),o=[];return r={},c("next"),c("throw"),c("return"),r[Symbol.asyncIterator]=function(){return this},r;function c(e){a[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=a[e](t)).value instanceof i?Promise.resolve(n.value.v).then(u,l):f(o[0][2],n)}catch(r){f(o[0][3],r)}var n}function u(e){s("next",e)}function l(e){s("throw",e)}function f(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s,u=n(205);(t.makeGetAsyncPacketIteratorOnWorkerThread=function(e,t){return function(n){var r=n.data,c=n.frameSize,s=n.kek,u=n.chunkSize;return o(this,arguments,(function(){var n,o,l,f,d,p,h,v,m,y;return a(this,(function(a){switch(a.label){case 0:o=function(){n.postMessage({action:"init",data:r,frameSize:c,kek:s,chunkSize:u},[r])},l=function(){n.postMessage({action:"getChunk"})},(n=e).onmessage=function(e){f(e.data)},d=0,p=r.byteLength,h=[],v=function(){var e=new Promise((function(e){f=function(n){null!==n&&(d+=n.data.byteLength,t&&t({totalBytes:p,encryptedBytes:d}),v()),e(n)}}));h.push(e),l()},o(),v(),m=0,a.label=1;case 1:return[4,i(h[m])];case 2:return null===(y=a.sent())?[3,5]:[4,i(y)];case 3:return[4,a.sent()];case 4:return a.sent(),delete h[m],m++,[3,1];case 5:return[2]}}))}))}},"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope)&&(onmessage=function(e){return r(void 0,void 0,void 0,(function(){var t,n,r,i,o,l,f,d,p,h,v;return a(this,(function(a){switch(a.label){case 0:return t=e.data,n=t.action,r=c(t,["action"]),"init"!==n?[3,1]:(v=r.data,i=r.frameSize,o=r.kek,l=r.chunkSize,s=u.getAsyncPacketIterator({data:v,frameSize:i,kek:o,chunkSize:l}),[3,3]);case 1:return"getChunk"!==n?[3,3]:[4,s.next()];case 2:f=a.sent(),d=f.value,f.done?(postMessage(null),self.close()):(p=d.key,h=d.iv,v=d.data,postMessage({key:p,iv:h,data:v},[v.buffer])),a.label=3;case 3:return[2]}}))}))})},216:function(e,t,n){e.exports=n.p+"static/media/chrome-icon.f3b6c54c.svg"},246:function(e,t,n){e.exports=n(416)},258:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(c){a={error:c}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(65),s=o(n(164)),u={b:1,w:2,d:4,q:8};t.formatQuery=function(e){for(var t,n,a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var l=[],f=null,d=Array.from(a),p=!1;try{for(var h=r(e),v=h.next();!v.done;v=h.next()){var m=v.value;if(p){p=!1;var y=d.shift();if(m in u)for(var b=s.default.BigInt(y),g=u[m]-1;g>=0;g--){var w=s.default.signedRightShift(b,s.default.BigInt(8*g));w=s.default.bitwiseAnd(w,s.default.BigInt(255)),l.push(s.default.toNumber(w))}else if("x"===m||"s"===m){var k=c.assertString(y),x=k.length;"s"===m&&(x+=1),l.push(x>>8&255),l.push(255&x),l.push.apply(l,i(c.stringToCharCodeArray(k))),"s"===m&&l.push(0)}else"*"===m?"string"===typeof y?l.push.apply(l,i(c.stringToCharCodeArray(y))):y instanceof Uint8Array?l.push.apply(l,i(y)):c.assert(!1,"Unexpected type for value"):c.assert(!1,"Unrecognized format char "+m)}else"%"!==m?" "!==m&&(null===f?f=m:(l.push(Number.parseInt(f+m,16)),f=null)):(c.assert(null===f,'Expected "half" to be null'),p=!0)}}catch(E){t={error:E}}finally{try{v&&!v.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}return new Uint8Array(l).buffer},t.scanQuery=function(e,t){var n,a,o,l=[],f=(o=e instanceof ArrayBuffer?Array.from(new Uint8Array(e)):e).length,d=null,p=!1;try{for(var h=r(t),v=h.next();!v.done;v=h.next()){var m=v.value;if(p){if(p=!1,"?"===m){o.shift();continue}if(m in u){for(var y=s.default.BigInt(0),b=u[m]-1;b>=0;b--){var g=s.default.BigInt(o.shift());g=s.default.leftShift(g,s.default.BigInt(8*b)),y=s.default.bitwiseOr(y,g)}l.push(y)}else if("s"===m||"x"===m){var w=o.shift()<<8|o.shift(),k=o.splice(w);y=String.fromCharCode.apply(String,i(o));o=k,"s"===m?l.push(y.substring(0,y.length-1)):l.push(y)}else if("*"===m){y=String.fromCharCode.apply(String,i(o.splice(0)));l.push(y)}else{if("#"!==m)throw new Error("Unrecognized format char "+m);y=new Uint8Array(o.splice(0));l.push(y)}}else if("%"!==m){if(" "!==m)if(null===d)d=m;else{var x=o.shift(),E=Number.parseInt(d+m,16);if(E!=x){var S=f-o.length-1;throw new Error("Format and input mismatch at "+S+": expected "+E+", got "+x)}d=null}}else c.assert(null===d),p=!0}}catch(C){n={error:C}}finally{try{v&&!v.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return c.assert(0===o.length,o.length+" Bytes remaining to parse"),l},t.BCD2int=function(e){for(var t=0,n=0;0!==e;){var r=15&e;e>>>=4,t+=r*Math.pow(10,n),n+=1}return t},t.int2BCD=function(e,t){var n;if(void 0===t&&(t=1),t>4)throw new Error("Unsupported length. Max allowed is 4");if(e>Math.pow(10,2*t)-1)throw new Error("Value "+e+" cannot fit in "+t+" bytes in BCD");for(var r=0,i=0;e;)e=(n=a([Math.floor(e/10),e%10],2))[0],r|=n[1]<<4*i,i+=1;return r}},262:function(e,t){},264:function(e,t){},297:function(e,t){},298:function(e,t){},363:function(e,t,n){"use strict";var r,a,i,o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},s=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(c){a={error:c}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=n(162),f=n(163),d=n(65);(r={})[f.Encoding.sp]="sp",r[f.Encoding.lp2]="lp2",r[f.Encoding.lp4]="lp4",(a={})[f.Channels.mono]="mono",a[f.Channels.stereo]="stereo",(i={})[f.TrackFlag.protected]="protected",i[f.TrackFlag.unprotected]="unprotected";t.openPairedDevice=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return c(this,(function(a){switch(a.label){case 0:return[4,e.getDevices()];case 1:return 0===(n=a.sent()).length?[2,null]:[4,(r=new l.NetMD(n[0],0,t)).init()];case 2:return a.sent(),[2,new f.NetMDInterface(r)]}}))}))},t.openNewDevice=function(e,t){return o(this,void 0,void 0,(function(){var n,r,a;return c(this,(function(i){switch(i.label){case 0:n=l.DevicesIds.map((function(e){return{vendorId:e.vendorId,deviceId:e.deviceId}})),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.requestDevice({filters:n})];case 2:return r=i.sent(),[3,4];case 3:return i.sent(),[2,null];case 4:return[4,(a=new l.NetMD(r,0,t)).init()];case 5:return i.sent(),[2,new f.NetMDInterface(a)]}}))}))},t.listDevice=function(e){var t,n,r,a;return o(this,void 0,void 0,(function(){var i,o,s;return c(this,(function(c){switch(c.label){case 0:return i=l.DevicesIds.map((function(e){return{vendorId:e.vendorId,deviceId:e.deviceId}})),[4,e.requestDevice({filters:i})];case 1:return o=c.sent(),s=l.DevicesIds.find((function(e){return e.deviceId==o.productId&&e.vendorId===o.vendorId})),[2,{manufacturerName:(t=o.manufacturerName,null!==t&&void 0!==t?t:"unknown"),productName:(n=o.productName,null!==n&&void 0!==n?n:"unknown"),vendorId:o.vendorId,productId:o.productId,name:(a=null===(r=s)||void 0===r?void 0:r.name,null!==a&&void 0!==a?a:"unknown")}]}}))}))},t.countTracksInDisc=function(e){return e.groups.reduce((function(e,t,n){return e+t.tracks.length}),0)},t.getTracks=function(e){var t,n,r,a,i=[];try{for(var o=s(e.groups),c=o.next();!c.done;c=o.next()){var u=c.value;try{for(var l=(r=void 0,s(u.tracks)),f=l.next();!f.done;f=l.next()){var d=f.value;i.push(d)}}catch(p){r={error:p}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}}}catch(h){t={error:h}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},t.listContent=function(e){return o(this,void 0,void 0,(function(){var t,n,r,a,i,o,l,p,h,v,m,y,b,g,w,k,x,E,S,C,I,O,T,D,j,A,N,M,P,_,Q,B,F,W,L,U;return c(this,(function(c){switch(c.label){case 0:return[4,e.getDiscFlags()];case 1:return t=c.sent(),[4,e.getDiscTitle()];case 2:return n=c.sent(),[4,e.getDiscCapacity()];case 3:return r=u.apply(void 0,[c.sent(),3]),a=r[0],i=r[1],o=r[2],[4,e.getTrackCount()];case 4:return l=c.sent(),p={title:n,writable:!!(t&f.DiscFlag.writable),writeProtected:!!(t&f.DiscFlag.writeProtected),used:d.timeToFrames(a),left:d.timeToFrames(o),total:d.timeToFrames(i),trackCount:l,groups:[]},[4,e.getTrackGroupList()];case 5:h=c.sent(),c.label=6;case 6:c.trys.push([6,21,22,23]),v=s(h.entries()),m=v.next(),c.label=7;case 7:if(m.done)return[3,20];y=u(m.value,2),b=y[0],g=u(y[1],2),w=g[0],k=g[1],x={index:b,title:w,tracks:[]},p.groups.push(x),E=[],c.label=8;case 8:c.trys.push([8,16,17,18]),L=void 0,S=s(k.entries()),C=S.next(),c.label=9;case 9:return C.done?[3,15]:(I=u(C.value,2),O=I[0],T=I[1],[4,e.getTrackTitle(T)]);case 10:return D=c.sent(),[4,e.getTrackEncoding(T)];case 11:return j=u.apply(void 0,[c.sent(),2]),A=j[0],j[1],M=d.timeToFrames,[4,e.getTrackLength(T)];case 12:return N=M.apply(void 0,[c.sent()]),[4,e.getTrackFlags(T)];case 13:P=c.sent(),_={index:O,title:D,duration:N,encoding:A,protected:P},E.push(_),c.label=14;case 14:return C=S.next(),[3,9];case 15:return[3,18];case 16:return Q=c.sent(),L={error:Q},[3,18];case 17:try{C&&!C.done&&(U=S.return)&&U.call(S)}finally{if(L)throw L.error}return[7];case 18:x.tracks=x.tracks.concat(E),c.label=19;case 19:return m=v.next(),[3,7];case 20:return[3,23];case 21:return B=c.sent(),F={error:B},[3,23];case 22:try{m&&!m.done&&(W=v.return)&&W.call(v)}finally{if(F)throw F.error}return[7];case 23:return[2,p]}}))}))},t.download=function(e,t,n){return o(this,void 0,void 0,(function(){var r,a,i,o,s;return c(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,e.sessionKeyForget()];case 1:return c.sent(),[4,e.leaveSecureSession()];case 2:return c.sent(),[3,4];case 3:return c.sent(),[3,4];case 4:return[4,e.disableNewTrackProtection(1)];case 5:return c.sent(),[4,(r=new f.MDSession(e,new f.EKBOpenSource)).init()];case 6:return c.sent(),[4,r.downloadTrack(t,n)];case 7:return a=u.apply(void 0,[c.sent(),3]),i=a[0],o=a[1],s=a[2],[4,r.close()];case 8:return c.sent(),[2,[i,o,s]]}}))}))}},364:function(e,t,n){e.exports=function(){return new Worker(n.p+"5530d0d82e3e17dcc5cb.worker.js")}},396:function(e,t,n){},415:function(e,t,n){e.exports=function(){return new Worker(n.p+"e377e8c841742c6b7530.worker.js")}},416:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(16),o=n.n(i),c=n(18),s=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function u(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){console.log("state change",n.state),"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})},e.update()})).catch((function(e){console.error("Error during service worker registration:",e)}))}var l=n(6),f=n.n(l),d=n(13),p=n(43),h=n(30),v=n(20),m=n(212),y=n(364),b=function(){function e(){Object(p.a)(this,e),this.netmdInterface=void 0}return Object(h.a)(e,[{key:"pair",value:function(){var e=Object(d.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.openNewDevice)(navigator.usb);case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",!1);case 5:return this.netmdInterface=t,e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(d.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.openPairedDevice)(navigator.usb);case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",!1);case 5:return this.netmdInterface=t,e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"listContent",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.listContent)(this.netmdInterface);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDeviceName",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.netMd.getDeviceName();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalize",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.netMd.finalize();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renameTrack",value:function(){var e=Object(d.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.setTrackTitle(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renameDisc",value:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.getDiscTitle();case 2:return n=e.sent,e.next=5,this.netmdInterface._getDiscTitle();case 5:return r=(r=e.sent).replace(n,t),e.next=9,this.netmdInterface.cacheTOC();case 9:return e.next=11,this.netmdInterface.setDiscTitle(r);case 11:return e.next=13,this.netmdInterface.syncTOC();case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteTrack",value:function(){var e=Object(d.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.eraseTrack(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"wipeDisc",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.eraseDisc();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"moveTrack",value:function(){var e=Object(d.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.moveTrack(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object(d.a)(f.a.mark((function e(t,n,r,a){var i,o,c,s,u,l,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){a({written:o,encrypted:c,total:i})},i=n.byteLength,o=0,c=0,u=new y,l=Object(m.makeGetAsyncPacketIteratorOnWorkerThread)(u,(function(e){var t=e.encryptedBytes;c=t,s()})),d=new v.MDTrack(t,r,n,524288,l),e.next=9,Object(v.download)(this.netmdInterface,d,(function(e){var t=e.writtenBytes;o=t,s()}));case 9:u.terminate();case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.play();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.stop();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"next",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.nextTrack();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prev",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.previousTrack();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),g={},w=n(25),k=n(28),x=n(17),E=Object(k.b)({name:"uploadDialog",initialState:{visible:!1,writtenProgress:0,encryptedProgress:0,totalProgress:1,trackTotal:1,trackConverting:0,trackCurrent:0,titleCurrent:"",titleConverting:""},reducers:{setVisible:function(e,t){e.visible=t.payload},setWriteProgress:function(e,t){e.encryptedProgress=t.payload.encrypted,e.writtenProgress=t.payload.written,e.totalProgress=t.payload.total},setTrackProgress:function(e,t){e.trackTotal=t.payload.total,e.trackCurrent=t.payload.current,e.trackConverting=t.payload.converting,e.titleCurrent=t.payload.titleCurrent,e.titleConverting=t.payload.titleConverting}}}),S=E.reducer,C=E.actions,I=Object(x.enableBatching)(S),O=Object(k.b)({name:"renameDialog",initialState:{visible:!1,title:"",index:-1},reducers:{setVisible:function(e,t){e.visible=t.payload},setCurrentName:function(e,t){e.title=t.payload},setIndex:function(e,t){e.index=t.payload}}}),T=O.reducer,D=O.actions,j=Object(x.enableBatching)(T),A=Object(k.b)({name:"errorDialog",initialState:{visible:!1,error:""},reducers:{setVisible:function(e,t){e.visible=t.payload},setErrorMessage:function(e,t){e.error="".concat(t.payload)}}}),N=A.actions,M=A.reducer,P=Object(x.enableBatching)(M),_=Object(k.b)({name:"convertDialog",initialState:{visible:!1,format:"LP2"},reducers:{setVisible:function(e,t){e.visible=t.payload},setFormat:function(e,t){e.format=t.payload}}}),Q=_.actions,B=_.reducer,F=Object(x.enableBatching)(B);function W(e){return Object(c.d)(e,c.b)}function L(e){return"".concat("/webminidisc","/").concat(e)}var U={mainView:"WELCOME",loading:!1,pairingFailed:!1,pairingMessage:"",browserSupported:!0,darkMode:function(e,t){var n=localStorage.getItem(e);if(null===n)return t;try{return JSON.parse(n)}catch(r){return t}}("darkMode",!1),aboutDialogVisible:!1},R=Object(k.b)({name:"app",initialState:U,reducers:{setState:function(e,t){e.mainView=t.payload},setLoading:function(e,t){e.loading=t.payload},setPairingFailed:function(e,t){e.pairingFailed=t.payload},setPairingMessage:function(e,t){e.pairingMessage=t.payload},setBrowserSupported:function(e,t){e.browserSupported=t.payload},setDarkMode:function(e,t){var n,r;e.darkMode=t.payload,n="darkMode",r=e.darkMode,localStorage.setItem(n,JSON.stringify(r))},showAboutDialog:function(e,t){e.aboutDialogVisible=t.payload}}}),z=R.reducer,K=R.actions,H=Object(x.enableBatching)(z),V=Object(k.b)({name:"main",initialState:{disc:null,deviceName:""},reducers:{setDisc:function(e,t){e.disc=t.payload},setDeviceName:function(e,t){e.deviceName=t.payload}}}),Z=V.reducer,q=V.actions,G=Object(x.enableBatching)(Z),J=Object(k.a)({reducer:{renameDialog:j,uploadDialog:I,errorDialog:P,convertDialog:F,appState:H,main:G},middleware:Object(w.a)(Object(k.c)())}),X=n(9),Y=n(478),$=n(421),ee=n(479),te=n(466),ne=n(228),re=n(470),ae=n(26),ie=(n(370),n(231)),oe=n(214);function ce(){return function(){var e=Object(d.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(K.setLoading(!0)),e.next=3,g.netmdService.listContent();case 3:return n=e.sent,e.next=6,g.netmdService.getDeviceName();case 6:r=e.sent,t(Object(x.batchActions)([q.setDisc(n),q.setDeviceName(r),K.setLoading(!1)]));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}var se={SP:v.Wireformat.pcm,LP2:v.Wireformat.lp2,LP105:v.Wireformat.l105kbps,LP4:v.Wireformat.lp4};var ue,le,fe=n(463),de=n(145),pe=n(422),he=n(423),ve=n(480),me=n(461),ye=n(455),be=n(462),ge=n(459),we=n(460),ke=n(458),xe=n(454),Ee=a.a.forwardRef((function(e,t){return a.a.createElement(xe.a,Object.assign({direction:"up",ref:t},e))})),Se=function(e){var t=Object(c.c)(),n=W((function(e){return e.appState.aboutDialogVisible}));return a.a.createElement(ye.a,{open:n,maxWidth:"sm",fullWidth:!0,TransitionComponent:Ee,"aria-labelledby":"about-dialog-slide-title"},a.a.createElement(ke.a,{id:"about-dialog-slide-title"},"About Web MiniDisc"),a.a.createElement(ge.a,null,a.a.createElement(we.a,null,"Web MiniDisc has been made possible by"),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://www.ffmpeg.org/",target:"_blank"},"FFmpeg")," ","and"," ",a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://github.com/ffmpegjs/FFmpeg",target:"_blank"},"ffmpegjs"),", to read your audio files (wav, mp3, ogg, mp4, etc...)."),a.a.createElement("li",null,a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://github.com/dcherednik/atracdenc/",target:"_blank"},"Atracdenc"),", to support atrac3 encoding (lp2, lp4 audio formats)."),a.a.createElement("li",null,a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://emscripten.org/",target:"_blank"},"Emscripten"),", to run both FFmpeg and Atracdenc in the browser."),a.a.createElement("li",null,a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/netmd-js",target:"_blank"},"netmd-js"),", to send commands to NetMD devices using Javascript."),a.a.createElement("li",null,a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://github.com/glaubitz/linux-minidisc",target:"_blank"},"linux-minidisc"),", to make the netmd-js project possible."),a.a.createElement("li",null,a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://material-ui.com/",target:"_blank"},"material-ui"),", to build the user interface.")),a.a.createElement(we.a,null,"Attribution"),a.a.createElement("ul",null,a.a.createElement("li",null,"MiniDisc logo from"," ",a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://en.wikipedia.org/wiki/MiniDisc",target:"_blank"},"https://en.wikipedia.org/wiki/MiniDisc")),a.a.createElement("li",null,"MiniDisc icon from"," ",a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://www.deviantart.com/blinkybill/art/Sony-MiniDisc-Plastic-Icon-473812540",target:"_blank"},"http://fav.me/d7u3g3g")))),a.a.createElement(be.a,null,a.a.createElement(fe.a,{onClick:function(){t(K.showAboutDialog(!1))}},"Close")))},Ce=n(464),Ie=n(230),Oe=n(482),Te=n(215),De=n.n(Te),je=function(){var e=Object(c.c)(),t=W((function(e){return e.appState})).mainView,n=W((function(e){return e.main.disc})),r=a.a.useState(null),i=Object(ae.a)(r,2),o=i[0],s=i[1],u=Boolean(o),l=function(){s(null)},p=[];return"MAIN"===t&&(p.push(a.a.createElement(Oe.a,{key:"update",onClick:function(){e(ce()),l()}},"Refresh")),p.push(a.a.createElement(Oe.a,{key:"title",onClick:function(){var t;e(Object(x.batchActions)([D.setVisible(!0),D.setCurrentName(null!==(t=null===n||void 0===n?void 0:n.title)&&void 0!==t?t:""),D.setIndex(-1)])),l()}},"Rename Disc")),p.push(a.a.createElement(Oe.a,{key:"wipe",onClick:function(){e(function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.netmdService,t(K.setLoading(!0)),e.next=4,n.wipeDisc();case 4:ce()(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l()}},"Wipe Disc")),p.push(a.a.createElement(Oe.a,{key:"exit",onClick:function(){e(K.setState("WELCOME")),l()}},"Exit"))),p.push(a.a.createElement(Oe.a,{key:"about",onClick:function(){e(K.showAboutDialog(!0)),l()}},"About")),p.push(a.a.createElement(Oe.a,{key:"github",onClick:l},a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/webminidisc",target:"_blank"},"Fork me on GitHub"))),a.a.createElement(a.a.Fragment,null,a.a.createElement(Ce.a,{"aria-label":"actions","aria-controls":"actions-menu","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)}},a.a.createElement(De.a,null)),a.a.createElement(Ie.a,{id:"actions-menu",anchorEl:o,keepMounted:!0,open:u,onClose:l},p))},Ae=n(216),Ne=n.n(Ae),Me=Object(te.a)((function(e){return{main:{position:"relative",flex:"1 1 auto",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(3),minWidth:150},spacing:{marginTop:e.spacing(1)},chromeLogo:{marginTop:e.spacing(1),width:96,height:96},why:{alignSelf:"flex-start",marginTop:e.spacing(3)},headBox:{display:"flex",justifyContent:"space-between"}}})),Pe=function(e){var t=Me(),n=Object(c.c)(),i=W((function(e){return e.appState})),o=i.browserSupported,s=i.pairingFailed,u=i.pairingMessage;u.toLowerCase().match(/denied/);var l=Object(r.useState)(!1),p=Object(ae.a)(l,2),h=p[0],v=p[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(ve.a,{className:t.headBox},a.a.createElement(de.a,{component:"h1",variant:"h4"},"Web MiniDisc"),a.a.createElement(je,null)),a.a.createElement(de.a,{component:"h2",variant:"body2"},"Brings NetMD Devices to the Web"),a.a.createElement(ve.a,{className:t.main},o?a.a.createElement(a.a.Fragment,null,a.a.createElement(de.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Press the button to connect to a NetMD device"),a.a.createElement(fe.a,{variant:"contained",color:"primary",onClick:function(){return n(function(){var e=Object(d.a)(f.a.mark((function e(t,n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(K.setPairingFailed(!1)),e.next=3,g.audioExportService.init();case 3:return e.prev=3,e.next=6,g.netmdService.connect();case 6:if(!e.sent){e.next=10;break}return t(K.setState("MAIN")),e.abrupt("return");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0);case 15:return e.prev=15,e.next=18,g.netmdService.pair();case 18:if(!e.sent){e.next=22;break}return t(K.setState("MAIN")),e.abrupt("return");case 22:t(Object(x.batchActions)([K.setPairingMessage("Connection Failed"),K.setPairingFailed(!0)])),e.next=30;break;case 25:e.prev=25,e.t1=e.catch(15),console.error(e.t1),r=e.t1.message,t(Object(x.batchActions)([K.setPairingMessage(r),K.setPairingFailed(!0)]));case 30:case"end":return e.stop()}}),e,null,[[3,12],[15,25]])})));return function(t,n){return e.apply(this,arguments)}}())},className:t.button},"Connect"),a.a.createElement(pe.a,{error:!0,className:t.spacing,style:{visibility:s?"visible":"hidden"}},a.a.createElement(he.a,null,u))):a.a.createElement(a.a.Fragment,null,a.a.createElement(de.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"This Web browser is not supported.\xa0",a.a.createElement(me.a,{rel:"noopener noreferrer",href:"#",onClick:function(e){e.preventDefault(),v(!0)}},"Learn Why")),a.a.createElement(me.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},a.a.createElement("img",{alt:"Chrome Logo",src:Ne.a,className:t.chromeLogo})),a.a.createElement(de.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Try using"," ",a.a.createElement(me.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},"Chrome")," ","instead"),h?a.a.createElement(a.a.Fragment,null,a.a.createElement(de.a,{component:"p",variant:"body2",className:t.why},"Web MiniDisc requires a browser that supports both"," ",a.a.createElement(me.a,{rel:"noopener noreferrer",target:"_blank",href:"https://wicg.github.io/webusb/"},"WebUSB")," ","and"," ",a.a.createElement(me.a,{rel:"noopener noreferrer",target:"_blank",href:"https://webassembly.org/"},"WebAssembly"),"."),a.a.createElement("ul",null,a.a.createElement("li",null,"WebUSB is needed to control the NetMD device via the USB connection to your computer."),a.a.createElement("li",null,"WebAssembly is used to convert the music to a MiniDisc compatible format"))):null)),a.a.createElement(Se,null))},_e=n(217),Qe=n(3),Be=n(229),Fe=n(15),We=n(477),Le=n(222),Ue=n.n(Le),Re=n(220),ze=n.n(Re),Ke=n(221),He=n.n(Ke),Ve=n(472),Ze=n(476),qe=n(475),Ge=n(473),Je=n(474),Xe=n(471),Ye=n(483),$e=n(468),et=a.a.forwardRef((function(e,t){return a.a.createElement(xe.a,Object.assign({direction:"up",ref:t},e))})),tt=function(e){var t=Object(c.c)(),n=W((function(e){return e.renameDialog.visible})),r=W((function(e){return e.renameDialog.title})),i=W((function(e){return e.renameDialog.index})),o=i<0?"Disc":"Track",s=function(){t(D.setVisible(!1))},u=function(){t(i<0?function(e){var t=e.newName;return(function(){var e=Object(d.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g.netmdService,e.next=3,r.renameDisc(t);case 3:n(D.setVisible(!1)),ce()(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}({newName:r}):function(e){var t=e.index,n=e.newName;return(function(){var e=Object(d.a)(f.a.mark((function e(r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.netmdService,r(D.setVisible(!1)),e.prev=2,e.next=5,a.renameTrack(t,n);case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0),r(Object(x.batchActions)([N.setVisible(!0),N.setErrorMessage("Rename failed.")]));case 11:ce()(r);case 12:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}())}({index:i,newName:r}))};return a.a.createElement(ye.a,{open:n,onClose:s,maxWidth:"sm",fullWidth:!0,TransitionComponent:et,"aria-labelledby":"rename-dialog-title"},a.a.createElement(ke.a,{id:"rename-dialog-title"},"Rename ",o),a.a.createElement(ge.a,null,a.a.createElement($e.a,{autoFocus:!0,id:"name",label:"".concat(o," Name"),type:"text",fullWidth:!0,value:r,onKeyDown:function(e){"Enter"===e.key&&u()},onChange:function(e){t(D.setCurrentName(e.target.value.substring(0,120)))}})),a.a.createElement(be.a,null,a.a.createElement(fe.a,{onClick:s},"Cancel"),a.a.createElement(fe.a,{color:"primary",onClick:u},"Rename")))},nt=n(469),rt=Object(te.a)((function(e){return{progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)},uploadLabel:{marginTop:e.spacing(3)}}})),at=a.a.forwardRef((function(e,t){return a.a.createElement(xe.a,Object.assign({direction:"up",ref:t},e))})),it=function(e){var t=rt(),n=W((function(e){return e.uploadDialog})),r=n.visible,i=n.writtenProgress,o=n.encryptedProgress,c=n.totalProgress,s=n.trackTotal,u=n.trackCurrent,l=n.trackConverting,f=n.titleCurrent,d=n.titleConverting,p=Math.floor(i/c*100),h=Math.floor(o/c*100),v=Math.floor(l/s*100);return a.a.createElement(ye.a,{open:r,maxWidth:"sm",fullWidth:!0,TransitionComponent:at,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},a.a.createElement(ke.a,{id:"alert-dialog-slide-title"},"Recording..."),a.a.createElement(ge.a,null,a.a.createElement(we.a,{id:"alert-dialog-slide-description"},100===v&&l===s?"Conversion completed":"Converting ".concat(l+1," of ").concat(s,": ").concat(d)),a.a.createElement(nt.a,{className:t.progressBar,variant:0===v?"indeterminate":"determinate",color:"primary",value:v}),a.a.createElement(ve.a,{className:t.progressPerc},v,"%"),a.a.createElement(we.a,{id:"alert-dialog-slide-description",className:t.uploadLabel},"Uploading ",u," of ",s,": ",f),a.a.createElement(nt.a,{className:t.progressBar,variant:"buffer",color:"secondary",value:p,valueBuffer:h}),a.a.createElement(ve.a,{className:t.progressPerc},p,"%")),a.a.createElement(be.a,null))},ot=a.a.forwardRef((function(e,t){return a.a.createElement(xe.a,Object.assign({direction:"up",ref:t},e))})),ct=function(e){var t=Object(c.c)(),n=W((function(e){return e.errorDialog})),r=n.visible,i=n.error;return a.a.createElement(ye.a,{open:r,maxWidth:"sm",fullWidth:!0,TransitionComponent:ot,"aria-labelledby":"error-dialog-slide-title","aria-describedby":"error-dialog-slide-description"},a.a.createElement(ke.a,{id:"alert-dialog-slide-title"},"Error"),a.a.createElement(ge.a,null,a.a.createElement(we.a,{id:"alert-dialog-slide-description"},i)),a.a.createElement(be.a,null,a.a.createElement(fe.a,{onClick:function(){t(N.setVisible(!1))}},"Close")))},st=n(428),ut=n(426),lt=n(424),ft=a.a.forwardRef((function(e,t){return a.a.createElement(xe.a,Object.assign({direction:"up",ref:t},e))})),dt=Object(te.a)((function(e){return{container:{display:"flex",flexDirection:"row"},formControl:{minWidth:120}}})),pt=function(e){var t=Object(c.c)(),n=dt(),r=W((function(e){return e.convertDialog})),i=r.visible,o=r.format,s=function(){t(Q.setVisible(!1))};return a.a.createElement(ye.a,{open:i,maxWidth:"xs",fullWidth:!0,TransitionComponent:ft,"aria-labelledby":"convert-dialog-slide-title","aria-describedby":"convert-dialog-slide-description"},a.a.createElement(ke.a,{id:"convert-dialog-slide-title"},"Upload Settings"),a.a.createElement(ge.a,null,a.a.createElement(pe.a,{className:n.formControl},a.a.createElement(st.a,{color:"secondary",id:"convert-dialog-format"},"Format"),a.a.createElement(ut.a,{labelId:"convert-dialog-format-label",id:"convert-dialog-format",value:o,color:"secondary",onChange:function(e){t(Q.setFormat(e.target.value))},input:a.a.createElement(lt.a,null)},a.a.createElement(Oe.a,{value:"SP"},"SP"),a.a.createElement(Oe.a,{value:"LP2"},"LP2"),a.a.createElement(Oe.a,{value:"LP4"},"LP4")))),a.a.createElement(be.a,null,a.a.createElement(fe.a,{onClick:s},"Cancel"),a.a.createElement(fe.a,{onClick:function(){s(),t(function(e,t){return function(){var n=Object(d.a)(f.a.mark((function n(r,a){var i,o,c,s,u,l,p,h,m,y,b,w,k,E,S,I,O,T,D,j,A,M,P,_;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=g.audioExportService,o=g.netmdService,c=se[t],r(C.setVisible(!0)),s=function(e){var t=e.written,n=e.encrypted,a=e.total;r(C.setWriteProgress({written:t,encrypted:n,total:a}))},u={current:0,converting:0,total:e.length,titleCurrent:"",titleConverting:""},l=function(){r(C.setTrackProgress(u))},p=function(){var e=Object(ie.a)(f.a.mark((function e(n){var r,a,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=function(){if(a===n.length)return u.converting=a,u.titleConverting="",void l();var e=n[a];u.converting=a,u.titleConverting=e.name,l(),a++,r.push(new Promise(function(){var n=Object(d.a)(f.a.mark((function n(r,a){var c;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i.prepare(e);case 3:return n.next=5,i.export({format:t});case 5:c=n.sent,o(),r({file:e,data:c}),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(0),y=n.t0,b="".concat(e.name,": Unsupported or unrecognized format"),a(n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t){return n.apply(this,arguments)}}()))},r=[],a=0,o(),c=0;case 5:if(!(c<r.length)){e.next=12;break}return e.next=8,r[c];case 8:delete r[c],c++,e.next=5;break;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=a().main.disc,m=h?1700-Object(v.getTracks)(h).map((function(e){return e.title||""})).reduce((function(e,t){return e+t.length}),0):-1,m=Math.floor(m/e.length),b="",w=1,k=!0,E=!1,n.prev=14,I=Object(oe.a)(p(e));case 16:return n.next=18,I.next();case 18:return O=n.sent,k=O.done,n.next=22,O.value;case 22:if(T=n.sent,k){n.next=47;break}return j=(D=T).file,A=D.data,M=j.name,(P=M.lastIndexOf("."))>0&&(M=M.substring(0,P)),m>-1&&(M=M.substring(0,m)),u.current=w++,u.titleCurrent=M,l(),s({written:0,encrypted:0,total:100}),n.prev=34,n.next=37,null===o||void 0===o?void 0:o.upload(M,A,c,s);case 37:n.next=44;break;case 39:return n.prev=39,n.t0=n.catch(34),y=n.t0,b="".concat(j.name,": Error uploading to device"),n.abrupt("break",47);case 44:k=!0,n.next=16;break;case 47:n.next=53;break;case 49:n.prev=49,n.t1=n.catch(14),E=!0,S=n.t1;case 53:if(n.prev=53,n.prev=54,k||null==I.return){n.next=58;break}return n.next=58,I.return();case 58:if(n.prev=58,!E){n.next=61;break}throw S;case 61:return n.finish(58);case 62:return n.finish(53);case 63:_=[C.setVisible(!1)],y&&(console.error(y),_=_.concat([N.setVisible(!0),N.setErrorMessage(b)])),r(Object(x.batchActions)(_)),ce()(r);case 67:case"end":return n.stop()}}),n,null,[[14,49,53,63],[34,39],[54,,58,62]])})));return function(e,t){return n.apply(this,arguments)}}()}(e.files,o))}},"Ok")))},ht=n(481),vt=n(142),mt=Object(te.a)((function(e){return{add:{position:"absolute",bottom:e.spacing(3),right:e.spacing(3)},main:{overflowY:"auto",flex:"1 1 auto",marginBottom:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2),outline:"none"},toolbar:Object(X.a)({marginTop:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2)},e.breakpoints.up(600+2*e.spacing(2)),{marginLeft:e.spacing(-3),marginRight:e.spacing(-3)}),toolbarLabel:{flex:"1 1 100%"},toolbarHighlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Fe.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},headBox:{display:"flex",justifyContent:"space-between"},spacing:{marginTop:e.spacing(1)},formatBadge:Object(_e.a)({},vt.styles(e).badge,{},vt.styles(e).colorPrimary,{position:"static",display:"inline-flex",border:"2px solid ".concat(e.palette.background.paper),padding:"0 4px"}),titleCell:{overflow:"hidden",maxWidth:"40ch",textOverflow:"ellipsis"},indexCell:{whiteSpace:"nowrap",paddingRight:0,width:"2ch"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),yt=(ue={},Object(X.a)(ue,v.Encoding.sp,"SP"),Object(X.a)(ue,v.Encoding.lp2,"LP2"),Object(X.a)(ue,v.Encoding.lp4,"LP4"),ue),bt=function(e){var t=Object(c.c)(),n=W((function(e){return e.main.disc})),i=W((function(e){return e.main.deviceName})),o=a.a.useState([]),s=Object(ae.a)(o,2),u=s[0],l=s[1],p=u.length,h=a.a.useState(null),m=Object(ae.a)(h,2),y=m[0],b=m[1],k=Object(r.useCallback)((function(e){b(e.currentTarget)}),[]),E=Object(r.useCallback)((function(){b(null)}),[]),S=Object(r.useCallback)((function(e){t(function(e,t){return function(){var n=Object(d.a)(f.a.mark((function n(r){var a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=g.netmdService,n.next=3,a.moveTrack(e,t);case 3:ce()(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(u[0],e)),E()}),[t,u]);Object(r.useEffect)((function(){t(ce())}),[t]),Object(r.useEffect)((function(){l([])}),[n]);var C=a.a.useState([]),I=Object(ae.a)(C,2),O=I[0],T=I[1],j=Object(r.useCallback)((function(e,n){T(e),t(Q.setVisible(!0))}),[t]),A=Object(Be.a)({onDrop:j,accept:"audio/*",noClick:!0}),N=A.getRootProps,M=A.getInputProps,P=A.isDragActive,_=A.open,B=mt(),F=[];if(null!==n){var L=!0,U=!1,R=void 0;try{for(var z,H=n.groups[Symbol.iterator]();!(L=(z=H.next()).done);L=!0){var V=z.value,Z=!0,q=!1,G=void 0;try{for(var J,Y=V.tracks[Symbol.iterator]();!(Z=(J=Y.next()).done);Z=!0){var ee,te,ne=J.value;F.push({index:ne.index,title:null!==(ee=ne.title)&&void 0!==ee?ee:"Unknown Title",group:null!==(te=V.title)&&void 0!==te?te:"",encoding:yt[ne.encoding],duration:Object(v.formatTimeFromFrames)(ne.duration,!1)})}}catch(ie){q=!0,G=ie}finally{try{Z||null==Y.return||Y.return()}finally{if(q)throw G}}}}catch(ie){U=!0,R=ie}finally{try{L||null==H.return||H.return()}finally{if(U)throw R}}}var re=function(e,r){var a,i,o=r,c=null!==(a=null===(i=Object(v.getTracks)(n).find((function(e){return e.index===o})))||void 0===i?void 0:i.title)&&void 0!==a?a:"";t(Object(x.batchActions)([D.setVisible(!0),D.setCurrentName(c),D.setIndex(o)]))};return a.a.createElement(a.a.Fragment,null,a.a.createElement(ve.a,{className:B.headBox},a.a.createElement(de.a,{component:"h1",variant:"h4"},i||"Loading..."),a.a.createElement(je,null)),a.a.createElement(de.a,{component:"h2",variant:"body2"},null!==n?"".concat(Object(v.formatTimeFromFrames)(n.left,!1)," left of ").concat(Object(v.formatTimeFromFrames)(n.total,!1)):"Loading..."),a.a.createElement(Xe.a,{className:Object(Qe.default)(B.toolbar,Object(X.a)({},B.toolbarHighlight,p>0))},p>0?a.a.createElement(ht.a,{indeterminate:p>0&&p<F.length,checked:p>0,onChange:function(e){u.length<F.length?l(F.map((function(e){return e.index}))):l([])},inputProps:{"aria-label":"select all tracks"}}):null,p>0?a.a.createElement(de.a,{className:B.toolbarLabel,color:"inherit",variant:"subtitle1"},p," selected"):a.a.createElement(de.a,{component:"h3",variant:"h6",className:B.toolbarLabel},(null===n||void 0===n?void 0:n.title)||"Untitled Disc"),1===p?a.a.createElement(a.a.Fragment,null,a.a.createElement(Ye.a,{title:"Move to Position"},a.a.createElement(fe.a,{"aria-controls":"move-menu","aria-label":"Move",onClick:k},"Move")),a.a.createElement(Ie.a,{id:"move-menu",anchorEl:y,open:!!y,onClose:E,PaperProps:{style:{maxHeight:300}}},Array(F.length).fill(null).map((function(e,t){return a.a.createElement(Oe.a,{key:"pos-".concat(t),onClick:function(){return S(t)}},t+1)})))):null,p>0?a.a.createElement(Ye.a,{title:"Delete"},a.a.createElement(Ce.a,{"aria-label":"delete",onClick:function(e){var n;t((n=u,function(){var e=Object(d.a)(f.a.mark((function e(t){var r,a,i,o,c,s,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=g.netmdService,t(K.setLoading(!0)),(n=n.sort()).reverse(),a=!0,i=!1,o=void 0,e.prev=7,c=n[Symbol.iterator]();case 9:if(a=(s=c.next()).done){e.next=16;break}return u=s.value,e.next=13,r.deleteTrack(u);case 13:a=!0,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),i=!0,o=e.t0;case 22:e.prev=22,e.prev=23,a||null==c.return||c.return();case 25:if(e.prev=25,!i){e.next=28;break}throw o;case 28:return e.finish(25);case 29:return e.finish(22);case 30:ce()(t);case 31:case"end":return e.stop()}}),e,null,[[7,18,22,30],[23,,25,29]])})));return function(t){return e.apply(this,arguments)}}()))}},a.a.createElement(ze.a,null))):null,p>0?a.a.createElement(Ye.a,{title:"Rename"},a.a.createElement(Ce.a,{"aria-label":"rename",disabled:1!==p,onClick:function(e){re(0,u[0])}},a.a.createElement(He.a,null))):null),a.a.createElement(ve.a,Object.assign({className:B.main},N()),a.a.createElement("input",M()),a.a.createElement(Ve.a,{size:"small"},a.a.createElement(Ge.a,null,a.a.createElement(Je.a,null,a.a.createElement(qe.a,{className:B.indexCell},"#"),a.a.createElement(qe.a,null,"Title"),a.a.createElement(qe.a,null,"Format"),a.a.createElement(qe.a,{align:"right"},"Duration"))),a.a.createElement(Ze.a,null,F.map((function(e){return a.a.createElement(Je.a,{hover:!0,selected:u.includes(e.index),key:e.index,onDoubleClick:function(t){return re(0,e.index)},onClick:function(t){return n=e.index,void(u.includes(n)?l(u.filter((function(e){return e!==n}))):l([].concat(Object(w.a)(u),[n])));var n}},a.a.createElement(qe.a,{className:B.indexCell},e.index+1),a.a.createElement(qe.a,{className:B.titleCell,title:e.title},e.title||"No Title"),a.a.createElement(qe.a,null,a.a.createElement("span",{className:B.formatBadge},e.encoding)),a.a.createElement(qe.a,{align:"right"},e.duration))})))),a.a.createElement($.a,{className:B.backdrop,open:P},"Drop your Music to Upload")),a.a.createElement(We.a,{color:"primary","aria-label":"add",className:B.add,onClick:_},a.a.createElement(Ue.a,null)),a.a.createElement(it,null),a.a.createElement(tt,null),a.a.createElement(ct,null),a.a.createElement(pt,{files:O}),a.a.createElement(Se,null))},gt=n(224),wt=n.n(gt),kt=n(225),xt=n.n(kt),Et=n(226),St=n.n(Et),Ct=n(223),It=n.n(Ct),Ot=function(){var e=Object(r.useCallback)((function(){var e;null===(e=g.netmdService)||void 0===e||e.prev()}),[]),t=Object(r.useCallback)((function(){var e;null===(e=g.netmdService)||void 0===e||e.play()}),[]),n=Object(r.useCallback)((function(){var e;null===(e=g.netmdService)||void 0===e||e.stop()}),[]),i=Object(r.useCallback)((function(){var e;null===(e=g.netmdService)||void 0===e||e.next()}),[]);return a.a.createElement(ve.a,null,a.a.createElement(Ce.a,{"aria-label":"prev",onClick:e},a.a.createElement(It.a,null)),a.a.createElement(Ce.a,{"aria-label":"play",onClick:t},a.a.createElement(wt.a,null)),a.a.createElement(Ce.a,{"aria-label":"stop",onClick:n},a.a.createElement(xt.a,null)),a.a.createElement(Ce.a,{"aria-label":"next",onClick:i},a.a.createElement(St.a,null)))},Tt=n(417),Dt=n(227),jt=n.n(Dt),At=Object(te.a)((function(e){return{layout:Object(X.a)({width:"auto",height:"100%"},e.breakpoints.up(600+2*e.spacing(2)),{width:600,marginLeft:"auto",marginRight:"auto"}),paper:Object(X.a)({position:"relative",display:"flex",flexDirection:"column",padding:e.spacing(2),height:"100%"},e.breakpoints.up(600+2*e.spacing(2)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3),height:600}),copyright:Object(X.a)({display:"flex",alignItems:"center"},e.breakpoints.down(600+2*e.spacing(2)),{flexWrap:"wrap"}),backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},minidiscLogo:{width:48},controlsContainer:Object(X.a)({flex:"1 1 auto",paddingLeft:e.spacing(3),paddingRight:e.spacing(8)},e.breakpoints.down(600+2*e.spacing(2)),{order:-1,width:"100%",paddingLeft:0})}})),Nt=Object(ne.a)({palette:{type:"dark",primary:{light:"#6ec6ff",main:"#2196f3",dark:"#0069c0",contrastText:"#fff"}}}),Mt=Object(ne.a)({palette:{type:"light"}}),Pt=function(){var e=At(),t=Object(c.c)(),n=W((function(e){return e.appState})),r=n.mainView,i=n.loading,o=n.darkMode;return a.a.createElement(a.a.Fragment,null,a.a.createElement(re.a,{theme:o?Nt:Mt},a.a.createElement(Y.a,null),a.a.createElement("main",{className:e.layout},a.a.createElement(Tt.a,{className:e.paper},"WELCOME"===r?a.a.createElement(Pe,null):null,"MAIN"===r?a.a.createElement(bt,null):null,a.a.createElement(ve.a,{className:e.copyright},a.a.createElement(Ce.a,{onClick:function(){return t(K.setDarkMode(!o))}},a.a.createElement(jt.a,{color:o?"secondary":void 0})),a.a.createElement(de.a,{variant:"body2",color:"textSecondary",style:{marginRight:"8px"}},"\xa9 ",a.a.createElement(me.a,{rel:"noopener noreferrer",color:"inherit",target:"_blank",href:"https://stefano.brilli.me/"},"Stefano Brilli")," ",(new Date).getFullYear(),"."),a.a.createElement(me.a,{rel:"noopener noreferrer",href:"https://twitter.com/share?ref_src=twsrc%5Etfw",className:"twitter-share-button","data-via":"thecybercase","data-hashtags":"MiniDisc","data-dnt":"true","data-show-count":"false"},"Tweet"),a.a.createElement(ve.a,{className:e.controlsContainer},"MAIN"===r?a.a.createElement(Ot,null):null)))),a.a.createElement($.a,{className:e.backdrop,open:i},a.a.createElement(ee.a,{color:"inherit"}))))},_t=(n(396),n(143)),Qt=n(2),Bt=function(){function e(t){Object(p.a)(this,e),this.worker=t,this.messageCallback=void 0,t.onmessage=this.handleMessage.bind(this)}return Object(h.a)(e,[{key:"init",value:function(){var e=Object(d.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.messageCallback=e,t.worker.postMessage({action:"init"})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"encode",value:function(){var e=Object(d.a)(f.a.mark((function e(t,n){var r,a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){a.messageCallback=e,a.worker.postMessage({action:"encode",bitrate:n,data:t},[t])}));case 2:return r=e.sent,e.abrupt("return",r.data.result);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){this.worker.terminate()}},{key:"handleMessage",value:function(e){this.messageCallback(e),this.messageCallback=void 0}}]),e}();"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&(onmessage=function(){var e=Object(d.a)(f.a.mark((function e(t){var n,r,a,i,o,c,s,u,l,d,p;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data,r=n.action,a=Object(Qt.a)(n,["action"]),"init"===r?(self.importScripts(L("atracdenc.js")),self.Module().then((function(e){le=e,self.postMessage({action:"init"}),le.setLogger&&le.setLogger((function(e,t){return console.log("".concat(t,": ").concat(e))}))}))):"encode"===r&&(i=a.bitrate,o=a.data,"inWavFile.wav","outAt3File.aea",c=new Uint8Array(o),le.FS.writeFile("".concat("inWavFile.wav"),c),le.callMain(["-e","atrac3","-i","inWavFile.wav","-o","outAt3File.aea","--bitrate",i]),s=le.FS.stat("outAt3File.aea"),u=s.size,l=new Uint8Array(u-96),d=le.FS.open("outAt3File.aea","r"),le.FS.read(d,l,0,l.length,96),le.FS.close(d),p=l.buffer,self.postMessage({action:"encode",result:p},[p]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var Ft=n(415),Wt=function(){function e(){Object(p.a)(this,e),this.ffmpegProcess=void 0,this.atracdencProcess=void 0,this.loglines=[],this.inFileName="",this.outFileNameNoExt=""}return Object(h.a)(e,[{key:"init",value:function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(_t.setLogging)(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"prepare",value:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,r=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loglines=[],this.ffmpegProcess=Object(_t.createWorker)({logger:function(e){r.loglines.push(e),console.log(e.action,e.message)},corePath:L("ffmpeg-core.js"),workerPath:L("worker.min.js")}),e.next=4,this.ffmpegProcess.load();case 4:return this.atracdencProcess=new Bt(new Ft),e.next=7,this.atracdencProcess.init();case 7:if(0!==(n=t.name.split(".").slice(-1)).length){e.next=10;break}throw new Error("Unrecognized file format: ".concat(t.name));case 10:return this.inFileName="inAudioFile.".concat(n[0]),this.outFileNameNoExt="outAudioFile",e.next=14,this.ffmpegProcess.write(this.inFileName,t);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"info",value:function(){var e=Object(d.a)(f.a.mark((function e(){var t,n,r,a,i,o,c,s,u,l,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ffmpegProcess.transcode(this.inFileName,"".concat(this.outFileNameNoExt,".metadata"),"-f ffmetadata");case 2:t=/Audio:\s(.*?),/,n=/Input #0,\s(.*?),/,r=null,a=null,i=!0,o=!1,c=void 0,e.prev=9,s=this.loglines[Symbol.iterator]();case 11:if(i=(u=s.next()).done){e.next=26;break}if(l=u.value,null===(d=l.message.match(t))){e.next=17;break}return r=d[1],e.abrupt("continue",23);case 17:if(null===(d=l.message.match(n))){e.next=21;break}return a=d[1],e.abrupt("continue",23);case 21:if(null===r||null===a){e.next=23;break}return e.abrupt("break",26);case 23:i=!0,e.next=11;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(9),o=!0,c=e.t0;case 32:e.prev=32,e.prev=33,i||null==s.return||s.return();case 35:if(e.prev=35,!o){e.next=38;break}throw c;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",{format:r,input:a});case 41:case"end":return e.stop()}}),e,this,[[9,28,32,40],[33,,35,39]])})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,r,a,i,o,c,s,u,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("SP"!==(n=t.format)){e.next=12;break}return a="".concat(this.outFileNameNoExt,".raw"),e.next=5,this.ffmpegProcess.transcode(this.inFileName,a,"-f s16be -ar 44100");case 5:return e.next=7,this.ffmpegProcess.read(a);case 7:i=e.sent,o=i.data,r=o.buffer,e.next=32;break;case 12:return c="".concat(this.outFileNameNoExt,".wav"),e.next=15,this.ffmpegProcess.transcode(this.inFileName,c,"-f wav -ar 44100");case 15:return e.next=17,this.ffmpegProcess.read(c);case 17:s=e.sent,u=s.data,l="0",e.t0=n,e.next="LP2"===e.t0?23:"LP105"===e.t0?25:"LP4"===e.t0?27:29;break;case 23:return l="128",e.abrupt("break",29);case 25:return l="102",e.abrupt("break",29);case 27:return l="64",e.abrupt("break",29);case 29:return e.next=31,this.atracdencProcess.encode(u.buffer,l);case 31:r=e.sent;case 32:return this.ffmpegProcess.worker.terminate(),this.atracdencProcess.terminate(),e.abrupt("return",r);case 35:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();g.netmdService=new b,g.audioExportService=new Wt,window.addEventListener("beforeunload",(function(e){J.getState().uploadDialog.visible&&(e.preventDefault(),e.returnValue="Warning! Recording will be interrupted")})),navigator&&navigator.usb?navigator.usb.ondisconnect=function(){J.dispatch(K.setState("WELCOME"))}:J.dispatch(K.setBrowserSupported(!1)),window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault()})),o.a.render(a.a.createElement(c.a,{store:J},a.a.createElement(Pt,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/webminidisc",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/webminidisc","/final-service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):u(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):u(t,e)}))}}()},65:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},i=this&&this.__values||function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function o(e,t){if(!e)throw t=t||"no message provided",new Error("Assertion failed: "+t)}function c(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e.getUint8(n)!==t.getUint8(n))return!1;return!0}function s(e){var t=Array(e.length);return e.forEach((function(e,n){return t[n]=String.fromCharCode(e)})),t.join("")}function u(e,t){var n=[];return t>0&&n.push(e>>>24),t>1&&n.push(e>>>16&255),t>2&&n.push(e>>>8&255),t>3&&n.push(255&e),n}function l(e,t){return(t+e).slice(-t.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=function(e){return r(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},t.withTimeout=function(e,t){var n=this;return new Promise((function(i,o){return r(n,void 0,void 0,(function(){var n,r;return a(this,(function(a){switch(a.label){case 0:return n=setTimeout((function(){o(new Error("Operation timed out"))}),e),[4,t()];case 1:return r=a.sent(),clearTimeout(n),i(r),[2]}}))}))}))},t.assert=o,t.assertBigInt=function(e,t){if("bigint"===typeof e)return e;throw o(!1,"Expected BigInt type - "+t)},t.assertNumber=function(e,t){if("number"===typeof e)return e;throw o(!1,"Expected number type - "+t)},t.assertString=function(e,t){if("string"===typeof e)return e;throw o(!1,"Expected string type - "+t)},t.stringToCharCodeArray=function(e){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t},t.arrayBuffersAreEqual=function(e,t){return c(new DataView(e),new DataView(t))},t.dataViewsAreEqual=c,t.isBigEndian=function(){return 18===new Uint8Array(new Uint32Array([305419896]).buffer)[0]},t.hexEncode=function(e){for(var t="",n=0;n<e.length;n++)t+=("0"+e.charCodeAt(n).toString(16)).slice(-2);return t},t.arrayBufferToBinaryString=function(e){return s(new Uint8Array(e))},t.uint8arrayToBinaryString=s,t.concatUint8Arrays=function(){for(var e,t,n,r,a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=0;try{for(var s=i(a),u=s.next();!u.done;u=s.next()){c+=(h=u.value).length}}catch(v){e={error:v}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}var l=new Uint8Array(c),f=0;try{for(var d=i(a),p=d.next();!p.done;p=d.next()){var h=p.value;l.set(h,f),f+=h.length}}catch(m){n={error:m}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return l},t.concatArrayBuffers=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},t.wordArrayToByteArray=function(e,t){void 0===t&&(t=e.sigBytes);for(var n,r=new Uint8Array(t),a=0,i=0;t>0;)n=u(e.words[a],Math.min(4,t)),r.set(n,i),t-=n.length,i+=n.length,a++;return r},t.timeToFrames=function(e){return o(4===e.length),512*(60*(60*e[0]+e[1])+e[2])+e[3]},t.pad=l,t.formatTimeFromFrames=function(e,t){void 0===t&&(t=!0);var n=e%512,r=(e=(e-n)/512)%60,a=(e=(e-r)/60)%60;return l(e=(e-a)/60,"00")+":"+l(a,"00")+":"+l(r,"00")+(t?"+"+l(n,"000"):"")},t.sanitizeTrackTitle=function(e){return encodeURIComponent(e)}}},[[246,1,2]]]);
//# sourceMappingURL=main.caa32d2c.chunk.js.map