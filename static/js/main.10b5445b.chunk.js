(this.webpackJsonpwebmd=this.webpackJsonpwebmd||[]).push([[0],{216:function(e,t,a){e.exports=a.p+"static/media/chrome-icon.f3b6c54c.svg"},244:function(e,t,a){e.exports=a(420)},267:function(e,t){},269:function(e,t){},302:function(e,t){},303:function(e,t){},400:function(e,t,a){},419:function(e,t,a){e.exports=function(){return new Worker(a.p+"2fad141346134fe4e0c3.worker.js")}},420:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(14),o=a.n(i),l=a(16),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){console.log("state change",a.state),"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})},e.update()})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=a(17),d=a(213);function m(e){return new Promise(t=>{setTimeout(t,e)})}async function p(e,t){let a=1,n=setInterval(()=>{a++,t(Math.min(100,1e3*a/e*100))},1e3);await m(e),window.clearInterval(n)}function g(e){return Object(l.d)(e,l.b)}function f(e){return`/webminidisc/${e}`}function b(e){return e.normalize("NFD").replace(/[^\x00-\x7F]/g,"")}const h=a(369);var v={},E=a(21),w=a(15),y=Object(E.b)({name:"uploadDialog",initialState:{visible:!1,writtenProgress:0,encryptedProgress:0,totalProgress:1,trackTotal:1,trackConverting:0,trackCurrent:0,titleCurrent:"",titleConverting:""},reducers:{setVisible:function(e,t){e.visible=t.payload},setWriteProgress:function(e,t){e.encryptedProgress=t.payload.encrypted,e.writtenProgress=t.payload.written,e.totalProgress=t.payload.total},setTrackProgress:function(e,t){e.trackTotal=t.payload.total,e.trackCurrent=t.payload.current,e.trackConverting=t.payload.converting,e.titleCurrent=t.payload.titleCurrent,e.titleConverting=t.payload.titleConverting}}}),k=y.reducer,C=y.actions,x=Object(w.enableBatching)(k),j=Object(E.b)({name:"renameDialog",initialState:{visible:!1,title:"",index:-1},reducers:{setVisible:function(e,t){e.visible=t.payload},setCurrentName:function(e,t){e.title=t.payload},setIndex:function(e,t){e.index=t.payload}}}),O=j.reducer,S=j.actions,D=Object(w.enableBatching)(O),N=Object(E.b)({name:"errorDialog",initialState:{visible:!1,error:""},reducers:{setVisible:function(e,t){e.visible=t.payload},setErrorMessage:function(e,t){e.error="".concat(t.payload)}}}),P=N.actions,T=N.reducer,M=Object(w.enableBatching)(T),I=Object(E.b)({name:"convertDialog",initialState:{visible:!1,format:"LP2"},reducers:{setVisible:function(e,t){e.visible=t.payload},setFormat:function(e,t){e.format=t.payload}}}),F=I.actions,W=I.reducer,L=Object(w.enableBatching)(W);const R=Object(E.b)({name:"dumpDialog",initialState:{visible:!1,inputDeviceId:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setInputDeviceId:(e,t)=>{e.inputDeviceId=t.payload}}}),{reducer:A,actions:B}=R;var V=Object(w.enableBatching)(A);const U=Object(E.b)({name:"recordDialog",initialState:{visible:!1,trackTotal:1,trackDone:0,trackCurrent:0,titleCurrent:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setProgress:(e,t)=>{e.trackTotal=t.payload.trackTotal,e.trackDone=t.payload.trackDone,e.trackCurrent=t.payload.trackCurrent,e.titleCurrent=t.payload.titleCurrent}}}),{reducer:_,actions:z}=U;var $=Object(w.enableBatching)(_),G={mainView:"WELCOME",loading:!1,pairingFailed:!1,pairingMessage:"",browserSupported:!0,darkMode:function(e,t){let a=localStorage.getItem(e);if(null===a)return t;try{return JSON.parse(a)}catch(n){return t}}("darkMode",!1),aboutDialogVisible:!1},J=Object(E.b)({name:"app",initialState:G,reducers:{setState:function(e,t){e.mainView=t.payload},setLoading:function(e,t){e.loading=t.payload},setPairingFailed:function(e,t){e.pairingFailed=t.payload},setPairingMessage:function(e,t){e.pairingMessage=t.payload},setBrowserSupported:function(e,t){e.browserSupported=t.payload},setDarkMode:function(e,t){var a,n;e.darkMode=t.payload,a="darkMode",n=e.darkMode,localStorage.setItem(a,JSON.stringify(n))},showAboutDialog:function(e,t){e.aboutDialogVisible=t.payload}}}),H=J.reducer,Y=J.actions,q=Object(w.enableBatching)(H),K=Object(E.b)({name:"main",initialState:{disc:null,deviceName:""},reducers:{setDisc:function(e,t){e.disc=t.payload},setDeviceName:function(e,t){e.deviceName=t.payload}}}),Q=K.reducer,X=K.actions,Z=Object(w.enableBatching)(Q);const ee=Object(E.a)({reducer:{renameDialog:D,uploadDialog:x,errorDialog:M,convertDialog:L,dumpDialog:V,recordDialog:$,appState:q,main:Z},middleware:[...Object(E.c)()]});var te=a(13),ae=a(481),ne=a(425),re=a(482),ie=a(469),oe=a(228),le=a(473),ce=a(34);function se(){return async function(e){e(Y.setLoading(!0));let t=await v.netmdService.listContent(),a=await v.netmdService.getDeviceName();e(Object(w.batchActions)([X.setDisc(t),X.setDeviceName(a),Y.setLoading(!1)]))}}const ue={SP:u.Wireformat.pcm,LP2:u.Wireformat.lp2,LP105:u.Wireformat.l105kbps,LP4:u.Wireformat.lp4};function de(e,t){return async function(a,n){const{audioExportService:r,netmdService:i}=v,o=ue[t];a(C.setVisible(!0));const l=({written:e,encrypted:t,total:n})=>{a(C.setWriteProgress({written:e,encrypted:t,total:n}))};let c={current:0,converting:0,total:e.length,titleCurrent:"",titleConverting:""};const s=()=>{a(C.setTrackProgress(c))};let d=n().main.disc,m=d?1700-Object(u.getTracks)(d).map(e=>e.title||"").reduce((e,t)=>e+t.length,0):-1;let p;m=Math.floor(m/e.length);let g="",f=1;for await(let u of async function*(e){let a=[],n=0;!function i(){if(n===e.length)return c.converting=n,c.titleConverting="",void s();let o=e[n];c.converting=n,c.titleConverting=o.name,s(),n++,a.push(new Promise(async(e,a)=>{let n;try{await r.prepare(o),n=await r.export({format:t}),i(),e({file:o,data:n})}catch(l){p=l,g=`${o.name}: Unsupported or unrecognized format`,a(l)}}))}();let i=0;for(;i<a.length;)yield await a[i],delete a[i],i++}(e)){const{file:e,data:t}=u;let a=e.name;const n=a.lastIndexOf(".");n>0&&(a=a.substring(0,n)),m>-1&&(a=a.substring(0,m)),c.current=f++,c.titleCurrent=a,s(),l({written:0,encrypted:0,total:100});try{await(null===i||void 0===i?void 0:i.upload(a,t,o,l))}catch(h){p=h,g=`${e.name}: Error uploading to device`;break}}let b=[C.setVisible(!1)];p&&(console.error(p),b=b.concat([P.setVisible(!0),P.setErrorMessage(g)])),a(Object(w.batchActions)(b)),se()(a)}}var me=a(466),pe=a(147),ge=a(426),fe=a(427),be=a(483),he=a(464),ve=a(458),Ee=a(465),we=a(462),ye=a(463),ke=a(461),Ce=a(457),xe=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),je=function(e){var t=Object(l.c)(),a=g((function(e){return e.appState.aboutDialogVisible}));return r.a.createElement(ve.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:xe,"aria-labelledby":"about-dialog-slide-title"},r.a.createElement(ke.a,{id:"about-dialog-slide-title"},"About Web MiniDisc"),r.a.createElement(we.a,null,r.a.createElement(ye.a,null,"Web MiniDisc has been made possible by"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://www.ffmpeg.org/",target:"_blank"},"FFmpeg")," ","and"," ",r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://github.com/ffmpegjs/FFmpeg",target:"_blank"},"ffmpegjs"),", to read your audio files (wav, mp3, ogg, mp4, etc...)."),r.a.createElement("li",null,r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://github.com/dcherednik/atracdenc/",target:"_blank"},"Atracdenc"),", to support atrac3 encoding (lp2, lp4 audio formats)."),r.a.createElement("li",null,r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://emscripten.org/",target:"_blank"},"Emscripten"),", to run both FFmpeg and Atracdenc in the browser."),r.a.createElement("li",null,r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/netmd-js",target:"_blank"},"netmd-js"),", to send commands to NetMD devices using Javascript."),r.a.createElement("li",null,r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://github.com/glaubitz/linux-minidisc",target:"_blank"},"linux-minidisc"),", to make the netmd-js project possible."),r.a.createElement("li",null,r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://material-ui.com/",target:"_blank"},"material-ui"),", to build the user interface.")),r.a.createElement(ye.a,null,"Attribution"),r.a.createElement("ul",null,r.a.createElement("li",null,"MiniDisc logo from"," ",r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://en.wikipedia.org/wiki/MiniDisc",target:"_blank"},"https://en.wikipedia.org/wiki/MiniDisc")),r.a.createElement("li",null,"MiniDisc icon from"," ",r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://www.deviantart.com/blinkybill/art/Sony-MiniDisc-Plastic-Icon-473812540",target:"_blank"},"http://fav.me/d7u3g3g")))),r.a.createElement(Ee.a,null,r.a.createElement(me.a,{onClick:function(){t(Y.showAboutDialog(!1))}},"Close")))},Oe=a(467),Se=a(230),De=a(485),Ne=a(215),Pe=a.n(Ne),Te=function(){var e=Object(l.c)(),t=g((function(e){return e.appState})).mainView,a=g((function(e){return e.main.disc})),n=r.a.useState(null),i=Object(ce.a)(n,2),o=i[0],c=i[1],s=Boolean(o),u=function(){c(null)},d=[];return"MAIN"===t&&(d.push(r.a.createElement(De.a,{key:"update",onClick:function(){e(se()),u()}},"Refresh")),d.push(r.a.createElement(De.a,{key:"title",onClick:function(){var t;e(Object(w.batchActions)([S.setVisible(!0),S.setCurrentName(null!==(t=null===a||void 0===a?void 0:a.title)&&void 0!==t?t:""),S.setIndex(-1)])),u()}},"Rename Disc")),d.push(r.a.createElement(De.a,{key:"wipe",onClick:function(){e((async function(e){const{netmdService:t}=v;e(Y.setLoading(!0)),await t.wipeDisc(),se()(e)})),u()}},"Wipe Disc")),d.push(r.a.createElement(De.a,{key:"exit",onClick:function(){e(Y.setState("WELCOME")),u()}},"Exit"))),d.push(r.a.createElement(De.a,{key:"about",onClick:function(){e(Y.showAboutDialog(!0)),u()}},"About")),d.push(r.a.createElement(De.a,{key:"github",onClick:u},r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/webminidisc",target:"_blank"},"Fork me on GitHub"))),r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe.a,{"aria-label":"actions","aria-controls":"actions-menu","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)}},r.a.createElement(Pe.a,null)),r.a.createElement(Se.a,{id:"actions-menu",anchorEl:o,keepMounted:!0,open:s,onClose:u},d))},Me=a(216),Ie=a.n(Me),Fe=Object(ie.a)((function(e){return{main:{position:"relative",flex:"1 1 auto",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(3),minWidth:150},spacing:{marginTop:e.spacing(1)},chromeLogo:{marginTop:e.spacing(1),width:96,height:96},why:{alignSelf:"flex-start",marginTop:e.spacing(3)},headBox:{display:"flex",justifyContent:"space-between"}}})),We=function(e){var t=Fe(),a=Object(l.c)(),i=g((function(e){return e.appState})),o=i.browserSupported,c=i.pairingFailed,s=i.pairingMessage;s.toLowerCase().match(/denied/);var u=Object(n.useState)(!1),d=Object(ce.a)(u,2),m=d[0],p=d[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(be.a,{className:t.headBox},r.a.createElement(pe.a,{component:"h1",variant:"h4"},"Web MiniDisc"),r.a.createElement(Te,null)),r.a.createElement(pe.a,{component:"h2",variant:"body2"},"Brings NetMD Devices to the Web"),r.a.createElement(be.a,{className:t.main},o?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Press the button to connect to a NetMD device"),r.a.createElement(me.a,{variant:"contained",color:"primary",onClick:function(){return a((async function(e,t){e(Y.setPairingFailed(!1)),await v.audioExportService.init();try{if(await v.netmdService.connect())return void e(Y.setState("MAIN"))}catch(a){console.error(a)}try{if(await v.netmdService.pair())return void e(Y.setState("MAIN"));e(Object(w.batchActions)([Y.setPairingMessage("Connection Failed"),Y.setPairingFailed(!0)]))}catch(a){console.error(a);let t=a.message;e(Object(w.batchActions)([Y.setPairingMessage(t),Y.setPairingFailed(!0)]))}}))},className:t.button},"Connect"),r.a.createElement(ge.a,{error:!0,className:t.spacing,style:{visibility:c?"visible":"hidden"}},r.a.createElement(fe.a,null,s))):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"This Web browser is not supported.\xa0",r.a.createElement(he.a,{rel:"noopener noreferrer",href:"#",onClick:function(e){e.preventDefault(),p(!0)}},"Learn Why")),r.a.createElement(he.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},r.a.createElement("img",{alt:"Chrome Logo",src:Ie.a,className:t.chromeLogo})),r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Try using"," ",r.a.createElement(he.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},"Chrome")," ","instead"),m?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"p",variant:"body2",className:t.why},"Web MiniDisc requires a browser that supports both"," ",r.a.createElement(he.a,{rel:"noopener noreferrer",target:"_blank",href:"https://wicg.github.io/webusb/"},"WebUSB")," ","and"," ",r.a.createElement(he.a,{rel:"noopener noreferrer",target:"_blank",href:"https://webassembly.org/"},"WebAssembly"),"."),r.a.createElement("ul",null,r.a.createElement("li",null,"WebUSB is needed to control the NetMD device via the USB connection to your computer."),r.a.createElement("li",null,"WebAssembly is used to convert the music to a MiniDisc compatible format"))):null)),r.a.createElement(je,null))},Le=a(3),Re=a(229),Ae=a(12),Be=a(480),Ve=a(225),Ue=a.n(Ve),_e=a(223),ze=a.n(_e),$e=a(224),Ge=a.n($e),Je=a(475),He=a(479),Ye=a(478),qe=a(476),Ke=a(477),Qe=a(474),Xe=a(486),Ze=a(471),et=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),tt=function(e){var t=Object(l.c)(),a=g((function(e){return e.renameDialog.visible})),n=g((function(e){return e.renameDialog.title})),i=g((function(e){return e.renameDialog.index})),o=i<0?"Disc":"Track",c=function(){t(S.setVisible(!1))},s=function(){t(i<0?function({newName:e}){return async function(t){const{netmdService:a}=v;await a.renameDisc(e),t(S.setVisible(!1)),se()(t)}}({newName:n}):function({index:e,newName:t}){return async function(a){const{netmdService:n}=v;a(S.setVisible(!1));try{await n.renameTrack(e,t)}catch(r){console.error(r),a(Object(w.batchActions)([P.setVisible(!0),P.setErrorMessage("Rename failed.")]))}se()(a)}}({index:i,newName:n}))};return r.a.createElement(ve.a,{open:a,onClose:c,maxWidth:"sm",fullWidth:!0,TransitionComponent:et,"aria-labelledby":"rename-dialog-title"},r.a.createElement(ke.a,{id:"rename-dialog-title"},"Rename ",o),r.a.createElement(we.a,null,r.a.createElement(Ze.a,{autoFocus:!0,id:"name",label:"".concat(o," Name"),type:"text",fullWidth:!0,value:n,onKeyDown:function(e){"Enter"===e.key&&s()},onChange:function(e){t(S.setCurrentName(e.target.value.substring(0,120)))}})),r.a.createElement(Ee.a,null,r.a.createElement(me.a,{onClick:c},"Cancel"),r.a.createElement(me.a,{color:"primary",onClick:s},"Rename")))},at=a(472),nt=Object(ie.a)((function(e){return{progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)},uploadLabel:{marginTop:e.spacing(3)}}})),rt=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),it=function(e){var t=nt(),a=g((function(e){return e.uploadDialog})),n=a.visible,i=a.writtenProgress,o=a.encryptedProgress,l=a.totalProgress,c=a.trackTotal,s=a.trackCurrent,u=a.trackConverting,d=a.titleCurrent,m=a.titleConverting,p=Math.floor(i/l*100),f=Math.floor(o/l*100),b=Math.floor(u/c*100);return r.a.createElement(ve.a,{open:n,maxWidth:"sm",fullWidth:!0,TransitionComponent:rt,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},r.a.createElement(ke.a,{id:"alert-dialog-slide-title"},"Recording..."),r.a.createElement(we.a,null,r.a.createElement(ye.a,{id:"alert-dialog-slide-description"},100===b&&u===c?"Conversion completed":"Converting ".concat(u+1," of ").concat(c,": ").concat(m)),r.a.createElement(at.a,{className:t.progressBar,variant:0===b?"indeterminate":"determinate",color:"primary",value:b}),r.a.createElement(be.a,{className:t.progressPerc},b,"%"),r.a.createElement(ye.a,{id:"alert-dialog-slide-description",className:t.uploadLabel},"Uploading ",s," of ",c,": ",d),r.a.createElement(at.a,{className:t.progressBar,variant:"buffer",color:"secondary",value:p,valueBuffer:f}),r.a.createElement(be.a,{className:t.progressPerc},p,"%")),r.a.createElement(Ee.a,null))};const ot=Object(ie.a)(e=>({progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)}})),lt=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),ct=e=>{const t=ot();let{visible:a,trackTotal:n,trackDone:i,trackCurrent:o,titleCurrent:l}=g(e=>e.recordDialog),c=Math.round(o);return r.a.createElement(ve.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:lt,"aria-labelledby":"record-dialog-slide-title","aria-describedby":"record-dialog-slide-description"},r.a.createElement(ke.a,{id:"record-dialog-slide-title"},"Recording..."),r.a.createElement(we.a,null,r.a.createElement(ye.a,{id:"record-dialog-slide-description"},`Recording track ${i+1} of ${n}: ${l}`),r.a.createElement(at.a,{className:t.progressBar,variant:o>=0?"determinate":"indeterminate",color:"primary",value:c}),r.a.createElement(be.a,{className:t.progressPerc},c>=0?`${c}%`:"")),r.a.createElement(Ee.a,null))};var st=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),ut=function(e){var t=Object(l.c)(),a=g((function(e){return e.errorDialog})),n=a.visible,i=a.error;return r.a.createElement(ve.a,{open:n,maxWidth:"sm",fullWidth:!0,TransitionComponent:st,"aria-labelledby":"error-dialog-slide-title","aria-describedby":"error-dialog-slide-description"},r.a.createElement(ke.a,{id:"alert-dialog-slide-title"},"Error"),r.a.createElement(we.a,null,r.a.createElement(ye.a,{id:"alert-dialog-slide-description"},i)),r.a.createElement(Ee.a,null,r.a.createElement(me.a,{onClick:function(){t(P.setVisible(!1))}},"Close")))},dt=a(432),mt=a(430),pt=a(428),gt=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),ft=Object(ie.a)((function(e){return{container:{display:"flex",flexDirection:"row"},formControl:{minWidth:120}}})),bt=function(e){var t=Object(l.c)(),a=ft(),n=g((function(e){return e.convertDialog})),i=n.visible,o=n.format,c=function(){t(F.setVisible(!1))};return r.a.createElement(ve.a,{open:i,maxWidth:"xs",fullWidth:!0,TransitionComponent:gt,"aria-labelledby":"convert-dialog-slide-title","aria-describedby":"convert-dialog-slide-description"},r.a.createElement(ke.a,{id:"convert-dialog-slide-title"},"Upload Settings"),r.a.createElement(we.a,null,r.a.createElement(ge.a,{className:a.formControl},r.a.createElement(dt.a,{color:"secondary",id:"convert-dialog-format"},"Format"),r.a.createElement(mt.a,{labelId:"convert-dialog-format-label",id:"convert-dialog-format",value:o,color:"secondary",onChange:function(e){t(F.setFormat(e.target.value))},input:r.a.createElement(pt.a,null)},r.a.createElement(De.a,{value:"SP"},"SP"),r.a.createElement(De.a,{value:"LP2"},"LP2"),r.a.createElement(De.a,{value:"LP4"},"LP4")))),r.a.createElement(Ee.a,null,r.a.createElement(me.a,{onClick:c},"Cancel"),r.a.createElement(me.a,{onClick:function(){c(),t(de(e.files,o))}},"Ok")))},ht=a(219),vt=a.n(ht),Et=a(220),wt=a.n(Et),yt=a(221),kt=a.n(yt),Ct=a(218),xt=a.n(Ct),jt=function(){var e=Object(n.useCallback)((function(){var e;null===(e=v.netmdService)||void 0===e||e.prev()}),[]),t=Object(n.useCallback)((function(){var e;null===(e=v.netmdService)||void 0===e||e.play()}),[]),a=Object(n.useCallback)((function(){var e;null===(e=v.netmdService)||void 0===e||e.stop()}),[]),i=Object(n.useCallback)((function(){var e;null===(e=v.netmdService)||void 0===e||e.next()}),[]);return r.a.createElement(be.a,null,r.a.createElement(Oe.a,{"aria-label":"prev",onClick:e},r.a.createElement(xt.a,null)),r.a.createElement(Oe.a,{"aria-label":"play",onClick:t},r.a.createElement(vt.a,null)),r.a.createElement(Oe.a,{"aria-label":"stop",onClick:a},r.a.createElement(wt.a,null)),r.a.createElement(Oe.a,{"aria-label":"next",onClick:i},r.a.createElement(kt.a,null)))};const Ot=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),St=Object(ie.a)(e=>({container:{display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",marginRight:-e.spacing(2)},formControl:{minWidth:120},selectEmpty:{marginTop:e.spacing(2)},head:{textShadow:"0px 0px 12px rgba(150, 150, 150, 1)",fontSize:e.typography.h2.fontSize,textAlign:"center",marginBottom:e.spacing(2)}})),Dt=({trackIndexes:e})=>{const t=Object(l.c)(),a=St(),[i,o]=Object(n.useState)([]),[c,s]=Object(n.useState)("");let{visible:d}=g(e=>e.dumpDialog);const f=Object(n.useCallback)(()=>{var e;s(""),null===(e=v.mediaRecorderService)||void 0===e||e.stopTestInput(),t(B.setVisible(!1))},[t]),b=Object(n.useCallback)(e=>{var t,a;const n=e.target.value;s(n),null===(t=v.mediaRecorderService)||void 0===t||t.stopTestInput(),null===(a=v.mediaRecorderService)||void 0===a||a.playTestInput(n)},[s]),h=Object(n.useCallback)(()=>{var a,n;t((a=e,n=c,async function(e,t){e(Object(w.batchActions)([z.setVisible(!0),z.setProgress({trackTotal:a.length,trackDone:0,trackCurrent:0,titleCurrent:""})]));let r=t().main.disc,i=Object(u.getTracks)(r).filter(e=>a.indexOf(e.index)>=0);const{netmdService:o,mediaRecorderService:l}=v;for(let[a,s]of i.entries()){var c;e(z.setProgress({trackTotal:i.length,trackDone:a,trackCurrent:-1,titleCurrent:null!==(c=s.title)&&void 0!==c?c:""})),await o.gotoTrack(s.index),await o.play(),console.log("Waiting for track to be ready to play");let t=await o.getPosition(),r=[s.index,0,0,1];for(;null===t||!r.every((e,a)=>r[a]===t[a]);)await m(250),t=await o.getPosition();await o.pause(),await(null===o||void 0===o?void 0:o.gotoTrack(s.index)),console.log("Track is ready to play"),await(null===l||void 0===l?void 0:l.initStream(n)),await(null===l||void 0===l?void 0:l.startRecording()),await o.play();let u=s.duration/512;await p(1e3*u,t=>{var n;e(z.setProgress({trackTotal:i.length,trackDone:a,trackCurrent:t,titleCurrent:null!==(n=s.title)&&void 0!==n?n:""}))}),await(null===l||void 0===l?void 0:l.stopRecording()),null===l||void 0===l||l.downloadRecorded(`${s.title}`),await(null===l||void 0===l?void 0:l.closeStream())}await o.stop(),e(z.setVisible(!1))})),f()},[e,c,t,f]);return Object(n.useEffect)(()=>{d&&async function(){await navigator.mediaDevices.getUserMedia({audio:!0});let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind).map(e=>({deviceId:e.deviceId,label:e.label}));o(e)}()},[d,o]),r.a.createElement(ve.a,{open:d,maxWidth:"sm",fullWidth:!0,TransitionComponent:Ot,"aria-labelledby":"dump-dialog-slide-title","aria-describedby":"dump-dialog-slide-description"},r.a.createElement(ke.a,{id:"dump-dialog-slide-title"},"Record Selected Tracks"),r.a.createElement(we.a,null,r.a.createElement(pe.a,{component:"p",variant:"h2",className:a.head},"\ud83d\udcbb \u2b05 \ud83d\udcbd"),r.a.createElement(pe.a,{component:"p",variant:"body2"},"1. Connect your MD Player line-out to your PC audio line-in."),r.a.createElement(pe.a,{component:"p",variant:"body2"},"2. Use the controls at the bottom right to play some tracks."),r.a.createElement(pe.a,{component:"p",variant:"body2"},"3. Select the input source. You should hear the tracks playing on your PC."),r.a.createElement(pe.a,{component:"p",variant:"body2"},"4. Adjust the input gain and the line-out volume of your device."),r.a.createElement(be.a,{className:a.container},r.a.createElement(ge.a,{className:a.formControl},r.a.createElement(mt.a,{value:c,onChange:b,displayEmpty:!0,className:a.selectEmpty},r.a.createElement(De.a,{value:"",disabled:!0},"Input Source"),i.map(e=>r.a.createElement(De.a,{key:e.deviceId,value:e.deviceId},e.label))),r.a.createElement(fe.a,null,"Input Source")),r.a.createElement(jt,null))),r.a.createElement(Ee.a,null,r.a.createElement(me.a,{onClick:f},"Cancel"),r.a.createElement(me.a,{onClick:h,disabled:""===c},"Start Record")))};var Nt=a(484),Pt=a(144);const Tt=Object(ie.a)(e=>({add:{position:"absolute",bottom:e.spacing(3),right:e.spacing(3)},main:{overflowY:"auto",flex:"1 1 auto",marginBottom:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2),outline:"none"},toolbar:{marginTop:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2),[e.breakpoints.up(600+2*e.spacing(2))]:{marginLeft:e.spacing(-3),marginRight:e.spacing(-3)}},toolbarLabel:{flex:"1 1 100%"},toolbarHighlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Ae.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},headBox:{display:"flex",justifyContent:"space-between"},spacing:{marginTop:e.spacing(1)},formatBadge:{...Pt.styles(e).badge,...Pt.styles(e).colorPrimary,position:"static",display:"inline-flex",border:`2px solid ${e.palette.background.paper}`,padding:"0 4px"},titleCell:{overflow:"hidden",maxWidth:"40ch",textOverflow:"ellipsis"},indexCell:{whiteSpace:"nowrap",paddingRight:0,width:"2ch"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})),Mt={[u.Encoding.sp]:"SP",[u.Encoding.lp2]:"LP2",[u.Encoding.lp4]:"LP4"},It=e=>{let t=Object(l.c)(),a=g(e=>e.main.disc),i=g(e=>e.main.deviceName);const[o,c]=r.a.useState([]),s=o.length,[d,m]=r.a.useState(null),p=Object(n.useCallback)(e=>{m(e.currentTarget)},[]),f=Object(n.useCallback)(()=>{m(null)},[]),b=Object(n.useCallback)(e=>{t(function(e,t){return async function(a){const{netmdService:n}=v;await n.moveTrack(e,t),se()(a)}}(o[0],e)),f()},[t,o,f]),h=Object(n.useCallback)(()=>{t(B.setVisible(!0))},[t]);Object(n.useEffect)(()=>{t(se())},[t]),Object(n.useEffect)(()=>{c([])},[a]);let[E,y]=r.a.useState([]);const k=Object(n.useCallback)((e,a)=>{y(e),t(F.setVisible(!0))},[t]),{getRootProps:C,getInputProps:x,isDragActive:j,open:O}=Object(Re.a)({onDrop:k,accept:"audio/*",noClick:!0}),D=Tt();let N=[];if(null!==a)for(let n of a.groups)for(let e of n.tracks){var P,T;N.push({index:e.index,title:null!==(P=e.title)&&void 0!==P?P:"Unknown Title",group:null!==(T=n.title)&&void 0!==T?T:"",encoding:Mt[e.encoding],duration:Object(u.formatTimeFromFrames)(e.duration,!1)})}N.sort((e,t)=>e.index-t.index);const M=(e,n)=>{var r,i;let o=n,l=null!==(r=null===(i=Object(u.getTracks)(a).find(e=>e.index===o))||void 0===i?void 0:i.title)&&void 0!==r?r:"";t(Object(w.batchActions)([S.setVisible(!0),S.setCurrentName(l),S.setIndex(o)]))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(be.a,{className:D.headBox},r.a.createElement(pe.a,{component:"h1",variant:"h4"},i||"Loading..."),r.a.createElement(Te,null)),r.a.createElement(pe.a,{component:"h2",variant:"body2"},null!==a?`${Object(u.formatTimeFromFrames)(a.left,!1)} left of ${Object(u.formatTimeFromFrames)(a.total,!1)}`:"Loading..."),r.a.createElement(Qe.a,{className:Object(Le.default)(D.toolbar,{[D.toolbarHighlight]:s>0})},s>0?r.a.createElement(Nt.a,{indeterminate:s>0&&s<N.length,checked:s>0,onChange:e=>{o.length<N.length?c(N.map(e=>e.index)):c([])},inputProps:{"aria-label":"select all tracks"}}):null,s>0?r.a.createElement(pe.a,{className:D.toolbarLabel,color:"inherit",variant:"subtitle1"},s," selected"):r.a.createElement(pe.a,{component:"h3",variant:"h6",className:D.toolbarLabel},(null===a||void 0===a?void 0:a.title)||"Untitled Disc"),1===s?r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe.a,{title:"Move to Position"},r.a.createElement(me.a,{"aria-controls":"move-menu","aria-label":"Move",onClick:p},"Move")),r.a.createElement(Se.a,{id:"move-menu",anchorEl:d,open:!!d,onClose:f,PaperProps:{style:{maxHeight:300}}},Array(N.length).fill(null).map((e,t)=>r.a.createElement(De.a,{key:`pos-${t}`,onClick:()=>b(t)},t+1)))):null,s>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe.a,{title:"Record from MD"},r.a.createElement(me.a,{"aria-label":"Record",onClick:h},"Record"))):null,s>0?r.a.createElement(Xe.a,{title:"Delete"},r.a.createElement(Oe.a,{"aria-label":"delete",onClick:e=>{var a;t((a=o,async function(e){const{netmdService:t}=v;e(Y.setLoading(!0)),(a=a.sort()).reverse();for(let n of a)await t.deleteTrack(n);se()(e)}))}},r.a.createElement(ze.a,null))):null,s>0?r.a.createElement(Xe.a,{title:"Rename"},r.a.createElement(Oe.a,{"aria-label":"rename",disabled:1!==s,onClick:e=>{M(0,o[0])}},r.a.createElement(Ge.a,null))):null),r.a.createElement(be.a,Object.assign({className:D.main},C()),r.a.createElement("input",x()),r.a.createElement(Je.a,{size:"small"},r.a.createElement(qe.a,null,r.a.createElement(Ke.a,null,r.a.createElement(Ye.a,{className:D.indexCell},"#"),r.a.createElement(Ye.a,null,"Title"),r.a.createElement(Ye.a,null,"Format"),r.a.createElement(Ye.a,{align:"right"},"Duration"))),r.a.createElement(He.a,null,N.map(e=>r.a.createElement(Ke.a,{hover:!0,selected:o.includes(e.index),key:e.index,onDoubleClick:t=>M(0,e.index),onClick:t=>{return a=e.index,void(o.includes(a)?c(o.filter(e=>e!==a)):c([...o,a]));var a}},r.a.createElement(Ye.a,{className:D.indexCell},e.index+1),r.a.createElement(Ye.a,{className:D.titleCell,title:e.title},e.title||"No Title"),r.a.createElement(Ye.a,null,r.a.createElement("span",{className:D.formatBadge},e.encoding)),r.a.createElement(Ye.a,{align:"right"},e.duration))))),r.a.createElement(ne.a,{className:D.backdrop,open:j},"Drop your Music to Upload")),r.a.createElement(Be.a,{color:"primary","aria-label":"add",className:D.add,onClick:O},r.a.createElement(Ue.a,null)),r.a.createElement(it,null),r.a.createElement(tt,null),r.a.createElement(ut,null),r.a.createElement(bt,{files:E}),r.a.createElement(ct,null),r.a.createElement(Dt,{trackIndexes:o}),r.a.createElement(je,null))};var Ft,Wt=a(421),Lt=a(226),Rt=a.n(Lt),At=Object(ie.a)((function(e){return{layout:Object(te.a)({width:"auto",height:"100%"},e.breakpoints.up(600+2*e.spacing(2)),{width:600,marginLeft:"auto",marginRight:"auto"}),paper:Object(te.a)({position:"relative",display:"flex",flexDirection:"column",padding:e.spacing(2),height:"100%"},e.breakpoints.up(600+2*e.spacing(2)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3),height:600}),copyright:Object(te.a)({display:"flex",alignItems:"center"},e.breakpoints.down(600+2*e.spacing(2)),{flexWrap:"wrap"}),backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},minidiscLogo:{width:48},controlsContainer:Object(te.a)({flex:"1 1 auto",paddingLeft:e.spacing(3),paddingRight:e.spacing(8)},e.breakpoints.down(600+2*e.spacing(2)),{order:-1,width:"100%",paddingLeft:0})}})),Bt=Object(oe.a)({palette:{type:"dark",primary:{light:"#6ec6ff",main:"#2196f3",dark:"#0069c0",contrastText:"#fff"}}}),Vt=Object(oe.a)({palette:{type:"light"}}),Ut=function(){var e=At(),t=Object(l.c)(),a=g((function(e){return e.appState})),n=a.mainView,i=a.loading,o=a.darkMode;return r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{theme:o?Bt:Vt},r.a.createElement(ae.a,null),r.a.createElement("main",{className:e.layout},r.a.createElement(Wt.a,{className:e.paper},"WELCOME"===n?r.a.createElement(We,null):null,"MAIN"===n?r.a.createElement(It,null):null,r.a.createElement(be.a,{className:e.copyright},r.a.createElement(Oe.a,{onClick:function(){return t(Y.setDarkMode(!o))}},r.a.createElement(Rt.a,{color:o?"secondary":void 0})),r.a.createElement(pe.a,{variant:"body2",color:"textSecondary",style:{marginRight:"8px"}},"\xa9 ",r.a.createElement(he.a,{rel:"noopener noreferrer",color:"inherit",target:"_blank",href:"https://stefano.brilli.me/"},"Stefano Brilli")," ",(new Date).getFullYear(),"."),r.a.createElement(he.a,{rel:"noopener noreferrer",href:"https://twitter.com/share?ref_src=twsrc%5Etfw",className:"twitter-share-button","data-via":"thecybercase","data-hashtags":"MiniDisc","data-dnt":"true","data-show-count":"false"},"Tweet"),r.a.createElement(be.a,{className:e.controlsContainer},"MAIN"===n?r.a.createElement(jt,null):null)))),r.a.createElement(ne.a,{className:e.backdrop,open:i},r.a.createElement(re.a,{color:"inherit"}))))},_t=(a(400),a(23)),zt=a.n(_t),$t=a(46),Gt=a(51),Jt=a(37),Ht=a(145),Yt=a(2),qt=function(){function e(t){Object(Gt.a)(this,e),this.worker=t,this.messageCallback=void 0,t.onmessage=this.handleMessage.bind(this)}return Object(Jt.a)(e,[{key:"init",value:function(){var e=Object($t.a)(zt.a.mark((function e(){var t=this;return zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.messageCallback=e,t.worker.postMessage({action:"init"})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"encode",value:function(){var e=Object($t.a)(zt.a.mark((function e(t,a){var n,r=this;return zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){r.messageCallback=e,r.worker.postMessage({action:"encode",bitrate:a,data:t},[t])}));case 2:return n=e.sent,e.abrupt("return",n.data.result);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){this.worker.terminate()}},{key:"handleMessage",value:function(e){this.messageCallback(e),this.messageCallback=void 0}}]),e}();"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&(onmessage=function(){var e=Object($t.a)(zt.a.mark((function e(t){var a,n,r,i,o,l,c,s,u,d,m;return zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.data,n=a.action,r=Object(Yt.a)(a,["action"]),"init"===n?(self.importScripts(f("atracdenc.js")),self.Module().then((function(e){Ft=e,self.postMessage({action:"init"}),Ft.setLogger&&Ft.setLogger((function(e,t){return console.log("".concat(t,": ").concat(e))}))}))):"encode"===n&&(i=r.bitrate,o=r.data,"inWavFile.wav","outAt3File.aea",l=new Uint8Array(o),Ft.FS.writeFile("".concat("inWavFile.wav"),l),Ft.callMain(["-e","atrac3","-i","inWavFile.wav","-o","outAt3File.aea","--bitrate",i]),c=Ft.FS.stat("outAt3File.aea"),s=c.size,u=new Uint8Array(s-96),d=Ft.FS.open("outAt3File.aea","r"),Ft.FS.read(d,u,0,u.length,96),Ft.FS.close(d),m=u.buffer,self.postMessage({action:"encode",result:m},[m]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var Kt=a(419),Qt=function(){function e(){Object(Gt.a)(this,e),this.ffmpegProcess=void 0,this.atracdencProcess=void 0,this.loglines=[],this.inFileName="",this.outFileNameNoExt=""}return Object(Jt.a)(e,[{key:"init",value:function(){var e=Object($t.a)(zt.a.mark((function e(){return zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(Ht.setLogging)(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"prepare",value:function(){var e=Object($t.a)(zt.a.mark((function e(t){var a,n=this;return zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loglines=[],this.ffmpegProcess=Object(Ht.createWorker)({logger:function(e){n.loglines.push(e),console.log(e.action,e.message)},corePath:f("ffmpeg-core.js"),workerPath:f("worker.min.js")}),e.next=4,this.ffmpegProcess.load();case 4:return this.atracdencProcess=new qt(new Kt),e.next=7,this.atracdencProcess.init();case 7:if(0!==(a=t.name.split(".").slice(-1)).length){e.next=10;break}throw new Error("Unrecognized file format: ".concat(t.name));case 10:return this.inFileName="inAudioFile.".concat(a[0]),this.outFileNameNoExt="outAudioFile",e.next=14,this.ffmpegProcess.write(this.inFileName,t);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"info",value:function(){var e=Object($t.a)(zt.a.mark((function e(){var t,a,n,r,i,o,l,c,s,u,d;return zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ffmpegProcess.transcode(this.inFileName,"".concat(this.outFileNameNoExt,".metadata"),"-f ffmetadata");case 2:t=/Audio:\s(.*?),/,a=/Input #0,\s(.*?),/,n=null,r=null,i=!0,o=!1,l=void 0,e.prev=9,c=this.loglines[Symbol.iterator]();case 11:if(i=(s=c.next()).done){e.next=26;break}if(u=s.value,null===(d=u.message.match(t))){e.next=17;break}return n=d[1],e.abrupt("continue",23);case 17:if(null===(d=u.message.match(a))){e.next=21;break}return r=d[1],e.abrupt("continue",23);case 21:if(null===n||null===r){e.next=23;break}return e.abrupt("break",26);case 23:i=!0,e.next=11;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(9),o=!0,l=e.t0;case 32:e.prev=32,e.prev=33,i||null==c.return||c.return();case 35:if(e.prev=35,!o){e.next=38;break}throw l;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",{format:n,input:r});case 41:case"end":return e.stop()}}),e,this,[[9,28,32,40],[33,,35,39]])})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=Object($t.a)(zt.a.mark((function e(t){var a,n,r,i,o,l,c,s,u;return zt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("SP"!==(a=t.format)){e.next=12;break}return r="".concat(this.outFileNameNoExt,".raw"),e.next=5,this.ffmpegProcess.transcode(this.inFileName,r,"-f s16be -ar 44100");case 5:return e.next=7,this.ffmpegProcess.read(r);case 7:i=e.sent,o=i.data,n=o.buffer,e.next=32;break;case 12:return l="".concat(this.outFileNameNoExt,".wav"),e.next=15,this.ffmpegProcess.transcode(this.inFileName,l,"-f wav -ar 44100");case 15:return e.next=17,this.ffmpegProcess.read(l);case 17:c=e.sent,s=c.data,u="0",e.t0=a,e.next="LP2"===e.t0?23:"LP105"===e.t0?25:"LP4"===e.t0?27:29;break;case 23:return u="128",e.abrupt("break",29);case 25:return u="102",e.abrupt("break",29);case 27:return u="64",e.abrupt("break",29);case 29:return e.next=31,this.atracdencProcess.encode(s.buffer,u);case 31:n=e.sent;case 32:return this.ffmpegProcess.worker.terminate(),this.atracdencProcess.terminate(),e.abrupt("return",n);case 35:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Xt=a(227),Zt=a.n(Xt);v.netmdService=new class{constructor({debug:e=!1}){if(this.netmdInterface=void 0,this.logger=void 0,e){const e=(...e)=>{e&&e[0]&&e[0].method&&console.log(...e)};this.logger={debug:e,info:e,warn:e,error:e,child:()=>this.logger}}}async pair(){let e=await Object(u.openNewDevice)(navigator.usb,this.logger);return null!==e&&(this.netmdInterface=e,!0)}async connect(){let e=await Object(u.openPairedDevice)(navigator.usb,this.logger);return null!==e&&(this.netmdInterface=e,!0)}async listContent(){return await Object(u.listContent)(this.netmdInterface)}async getDeviceName(){return await this.netmdInterface.netMd.getDeviceName()}async finalize(){await this.netmdInterface.netMd.finalize()}async renameTrack(e,t){t=b(t),await this.netmdInterface.setTrackTitle(e,t)}async renameDisc(e){const t=await this.netmdInterface.getDiscTitle();let a=await this.netmdInterface._getDiscTitle();a=a.replace(t,e),await this.netmdInterface.cacheTOC(),await this.netmdInterface.setDiscTitle(a),await this.netmdInterface.syncTOC()}async deleteTrack(e){await this.netmdInterface.eraseTrack(e),await m(100)}async wipeDisc(){await this.netmdInterface.eraseDisc()}async moveTrack(e,t){await this.netmdInterface.moveTrack(e,t)}async upload(e,t,a,n){let r=t.byteLength,i=0,o=0;function l(){n({written:i,encrypted:o,total:r})}let c=new h,s=Object(d.makeGetAsyncPacketIteratorOnWorkerThread)(c,({encryptedBytes:e})=>{o=e,l()});e=b(e);let m=new u.MDTrack(e,a,t,524288,s);await Object(u.download)(this.netmdInterface,m,({writtenBytes:e})=>{i=e,l()}),c.terminate()}async play(){await this.netmdInterface.play()}async pause(){await this.netmdInterface.pause()}async stop(){await this.netmdInterface.stop()}async next(){await this.netmdInterface.nextTrack()}async prev(){await this.netmdInterface.previousTrack()}async gotoTrack(e){await this.netmdInterface.gotoTrack(e)}async getPosition(){return await this.netmdInterface.getPosition()}}({debug:!0}),v.audioExportService=new Qt,v.mediaRecorderService=new class{constructor(){this.recorder=void 0,this.stream=void 0,this.audioContext=void 0,this.analyserNode=void 0,this.gainNode=void 0}playTestInput(e){this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.analyserNode=this.audioContext.createAnalyser(),this.initStream(e).then(()=>{this.audioContext.createMediaStreamSource(this.stream).connect(this.gainNode),this.gainNode.connect(this.analyserNode),this.analyserNode.connect(this.audioContext.destination)})}stopTestInput(){var e;this.audioContext&&(null===(e=this.audioContext)||void 0===e||e.close(),delete this.audioContext,this.closeStream())}async initStream(e){const t={autoGainControl:!1,channelCount:2,deviceId:e,echoCancellation:!1,noiseSuppression:!1,sampleRate:44100,highpassFilter:!1};this.stream=await navigator.mediaDevices.getUserMedia({audio:t});const a=this.stream.getAudioTracks();a.length>0&&console.log("Record Setings:",a[0].getSettings())}async startRecording(){this.audioContext=new AudioContext;const e=this.audioContext.createMediaStreamSource(this.stream);this.recorder=new Zt.a(e,{workerPath:f("recorderWorker.js")}),this.recorder.record()}async stopRecording(){this.recorder.stop()}async closeStream(){var e;null===(e=this.stream)||void 0===e||e.getTracks().forEach(e=>e.stop())}downloadRecorded(e){this.recorder.exportWAV(t=>{let a=URL.createObjectURL(t),n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=a,n.download=`${b(e)}.wav`,n.click(),window.URL.revokeObjectURL(a),document.body.removeChild(n)})}},function(){let e;window.addEventListener("beforeunload",e=>{ee.getState().uploadDialog.visible&&(e.preventDefault(),e.returnValue="Warning! Recording will be interrupted")}),navigator&&navigator.usb?navigator.usb.ondisconnect=function(){ee.dispatch(Y.setState("WELCOME"))}:ee.dispatch(Y.setBrowserSupported(!1)),window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t})}(),o.a.render(r.a.createElement(l.a,{store:ee},r.a.createElement(Ut,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/webminidisc",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/webminidisc","/final-service-worker.js");c?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):s(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):s(t,e)}))}}()}},[[244,1,2]]]);
//# sourceMappingURL=main.10b5445b.chunk.js.map