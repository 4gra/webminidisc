(this.webpackJsonpwebmd=this.webpackJsonpwebmd||[]).push([[0],{215:function(e,t,a){e.exports=a.p+"static/media/chrome-icon.f3b6c54c.svg"},241:function(e,t,a){e.exports=a(411)},257:function(e,t){},259:function(e,t){},292:function(e,t){},293:function(e,t){},391:function(e,t,a){},410:function(e,t,a){e.exports=function(){return new Worker(a.p+"ce95054843396120d61b.worker.js")}},411:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(15),c=a.n(i),o=a(17),l=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=a(6),p=a.n(u),m=a(16),f=a(43),d=a(30),b=a(20),g=a(211),h=a(359),v=function(){function e(){Object(f.a)(this,e),this.netmdInterface=void 0}return Object(d.a)(e,[{key:"pair",value:function(){var e=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.openNewDevice)(navigator.usb);case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",!1);case 5:return this.netmdInterface=t,e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.openPairedDevice)(navigator.usb);case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",!1);case 5:return this.netmdInterface=t,e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"listContent",value:function(){var e=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.listContent)(this.netmdInterface);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDeviceName",value:function(){var e=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.netMd.getDeviceName();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalize",value:function(){var e=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.netMd.finalize();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renameTrack",value:function(){var e=Object(m.a)(p.a.mark((function e(t,a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.setTrackTitle(t,a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"deleteTrack",value:function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.eraseTrack(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"wipeDisc",value:function(){var e=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netmdInterface.eraseDisc();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object(m.a)(p.a.mark((function e(t,a,n,r){var i,c,o,l,s,u,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){r({written:c,encrypted:o,total:i})},i=a.byteLength,c=0,o=0,s=new h,u=Object(g.makeGetAsyncPacketIteratorOnWorkerThread)(s,(function(e){var t=e.encryptedBytes;o=t,l()})),m=new b.MDTrack(t,n,a,u),e.next=9,Object(b.download)(this.netmdInterface,m,(function(e){var t=e.writtenBytes;c=t,l()}));case 9:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()}]),e}(),k={},w=a(24),E=a(28),y=a(19),x=Object(E.b)({name:"uploadDialog",initialState:{visible:!1,writtenProgress:0,encryptedProgress:0,totalProgress:1,trackTotal:1,trackConverting:0,trackCurrent:0,titleCurrent:"",titleConverting:""},reducers:{setVisible:function(e,t){e.visible=t.payload},setWriteProgress:function(e,t){e.encryptedProgress=t.payload.encrypted,e.writtenProgress=t.payload.written,e.totalProgress=t.payload.total},setTrackProgress:function(e,t){e.trackTotal=t.payload.total,e.trackCurrent=t.payload.current,e.trackConverting=t.payload.converting,e.titleCurrent=t.payload.titleCurrent,e.titleConverting=t.payload.titleConverting}}}),j=x.reducer,O=x.actions,C=Object(y.enableBatching)(j),N=Object(E.b)({name:"renameDialog",initialState:{visible:!1,title:"",index:-1},reducers:{setVisible:function(e,t){e.visible=t.payload},setCurrentName:function(e,t){e.title=t.payload},setIndex:function(e,t){e.index=t.payload}}}),S=N.reducer,P=N.actions,D=Object(y.enableBatching)(S),F=Object(E.b)({name:"errorDialog",initialState:{visible:!1,error:""},reducers:{setVisible:function(e,t){e.visible=t.payload},setErrorMessage:function(e,t){e.error="".concat(t.payload)}}}),M=F.actions,W=F.reducer,L=Object(y.enableBatching)(W),T=Object(E.b)({name:"convertDialog",initialState:{visible:!1,format:"LP2"},reducers:{setVisible:function(e,t){e.visible=t.payload},setFormat:function(e,t){e.format=t.payload}}}),A=T.actions,B=T.reducer,I=Object(y.enableBatching)(B);function V(e){return Object(o.d)(e,o.b)}var R={mainView:"WELCOME",loading:!1,pairingFailed:!1,pairingMessage:"",browserSupported:!0,darkMode:function(e,t){var a=localStorage.getItem(e);if(null===a)return t;try{return JSON.parse(a)}catch(n){return t}}("darkMode",!1),aboutDialogVisible:!1},_=Object(E.b)({name:"app",initialState:R,reducers:{setState:function(e,t){e.mainView=t.payload},setLoading:function(e,t){e.loading=t.payload},setPairingFailed:function(e,t){e.pairingFailed=t.payload},setPairingMessage:function(e,t){e.pairingMessage=t.payload},setBrowserSupported:function(e,t){e.browserSupported=t.payload},setDarkMode:function(e,t){var a,n;e.darkMode=t.payload,a="darkMode",n=e.darkMode,localStorage.setItem(a,JSON.stringify(n))},showAboutDialog:function(e,t){e.aboutDialogVisible=t.payload}}}),U=_.reducer,z=_.actions,J=Object(y.enableBatching)(U),G=Object(E.b)({name:"main",initialState:{disc:null,deviceName:""},reducers:{setDisc:function(e,t){e.disc=t.payload},setDeviceName:function(e,t){e.deviceName=t.payload}}}),H=G.reducer,Y=G.actions,q=Object(y.enableBatching)(H),K=Object(E.a)({reducer:{renameDialog:D,uploadDialog:C,errorDialog:L,convertDialog:I,appState:J,main:q},middleware:Object(w.a)(Object(E.c)())}),$=a(11),Q=a(474),X=a(416),Z=a(475),ee=a(462),te=a(223),ae=a(466),ne=a(27),re=(a(365),a(226)),ie=a(213);function ce(){return function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(z.setLoading(!0)),e.next=3,k.netmdService.listContent();case 3:return a=e.sent,e.next=6,k.netmdService.getDeviceName();case 6:n=e.sent,t(Object(y.batchActions)([Y.setDisc(a),Y.setDeviceName(n),z.setLoading(!1)]));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}var oe={SP:b.Wireformat.pcm,LP2:b.Wireformat.lp2,LP105:b.Wireformat.l105kbps,LP4:b.Wireformat.lp4};var le,se,ue=a(459),pe=a(145),me=a(417),fe=a(418),de=a(476),be=a(457),ge=a(451),he=a(458),ve=a(455),ke=a(456),we=a(454),Ee=a(450),ye=r.a.forwardRef((function(e,t){return r.a.createElement(Ee.a,Object.assign({direction:"up",ref:t},e))})),xe=function(e){var t=Object(o.c)(),a=V((function(e){return e.appState.aboutDialogVisible}));return r.a.createElement(ge.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:ye,"aria-labelledby":"about-dialog-slide-title"},r.a.createElement(we.a,{id:"about-dialog-slide-title"},"About Web MiniDisc"),r.a.createElement(ve.a,null,r.a.createElement(ke.a,null,"Web MiniDisc has been made possible by"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://www.ffmpeg.org/",target:"_blank"},"FFmpeg")," ","and"," ",r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://github.com/ffmpegjs/FFmpeg",target:"_blank"},"ffmpegjs"),", to read your audio files (wav, mp3, ogg, mp4, etc...)."),r.a.createElement("li",null,r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://github.com/dcherednik/atracdenc/",target:"_blank"},"Atracdenc"),", to support atrac3 encoding (lp2, lp4 audio formats)."),r.a.createElement("li",null,r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://emscripten.org/",target:"_blank"},"Emscripten"),", to run both FFmpeg and Atracdenc in the browser."),r.a.createElement("li",null,r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/netmd-js",target:"_blank"},"netmd-js"),", to send commands to NetMD devices using Javascript."),r.a.createElement("li",null,r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://github.com/glaubitz/linux-minidisc",target:"_blank"},"linux-minidisc"),", to make the netmd-js project possible."),r.a.createElement("li",null,r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://material-ui.com/",target:"_blank"},"material-ui"),", to build the user interface.")),r.a.createElement(ke.a,null,"Attribution"),r.a.createElement("ul",null,r.a.createElement("li",null,"MiniDisc logo from"," ",r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://en.wikipedia.org/wiki/MiniDisc",target:"_blank"},"https://en.wikipedia.org/wiki/MiniDisc")),r.a.createElement("li",null,"MiniDisc icon from"," ",r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://www.deviantart.com/blinkybill/art/Sony-MiniDisc-Plastic-Icon-473812540",target:"_blank"},"http://fav.me/d7u3g3g")))),r.a.createElement(he.a,null,r.a.createElement(ue.a,{onClick:function(){t(z.showAboutDialog(!1))}},"Close")))},je=a(460),Oe=a(225),Ce=a(479),Ne=a(214),Se=a.n(Ne),Pe=function(){var e=Object(o.c)(),t=V((function(e){return e.appState})).mainView,a=r.a.useState(null),n=Object(ne.a)(a,2),i=n[0],c=n[1],l=Boolean(i),s=function(){c(null)},u=[];return"MAIN"===t&&(u.push(r.a.createElement(Ce.a,{key:"update",onClick:function(){e(ce()),s()}},"Refresh")),u.push(r.a.createElement(Ce.a,{key:"wipe",onClick:function(){e(function(){var e=Object(m.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=k.netmdService,t(z.setLoading(!0)),e.next=4,a.wipeDisc();case 4:ce()(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),s()}},"Wipe Disc")),u.push(r.a.createElement(Ce.a,{key:"exit",onClick:function(){e(z.setState("WELCOME")),s()}},"Exit"))),u.push(r.a.createElement(Ce.a,{key:"about",onClick:function(){e(z.showAboutDialog(!0)),s()}},"About")),u.push(r.a.createElement(Ce.a,{key:"github",onClick:s},r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/webminidisc",target:"_blank"},"Fork me on GitHub"))),r.a.createElement(r.a.Fragment,null,r.a.createElement(je.a,{"aria-label":"actions","aria-controls":"actions-menu","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)}},r.a.createElement(Se.a,null)),r.a.createElement(Oe.a,{id:"actions-menu",anchorEl:i,keepMounted:!0,open:l,onClose:s},u))},De=a(215),Fe=a.n(De),Me=Object(ee.a)((function(e){return{main:{position:"relative",flex:"1 1 auto",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(3),minWidth:150},spacing:{marginTop:e.spacing(1)},chromeLogo:{marginTop:e.spacing(1),width:96,height:96},why:{alignSelf:"flex-start",marginTop:e.spacing(3)},headBox:{display:"flex",justifyContent:"space-between"}}})),We=function(e){var t=Me(),a=Object(o.c)(),i=V((function(e){return e.appState})),c=i.browserSupported,l=i.pairingFailed,s=i.pairingMessage;s.toLowerCase().match(/denied/);var u=Object(n.useState)(!1),f=Object(ne.a)(u,2),d=f[0],b=f[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(de.a,{className:t.headBox},r.a.createElement(pe.a,{component:"h1",variant:"h4"},"Web MiniDisc"),r.a.createElement(Pe,null)),r.a.createElement(pe.a,{component:"h2",variant:"body2"},"Brings NetMD Devices to the Web"),r.a.createElement(de.a,{className:t.main},c?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Press the button to connect to a NetMD device"),r.a.createElement(ue.a,{variant:"contained",color:"primary",onClick:function(){return a(function(){var e=Object(m.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(z.setPairingFailed(!1)),e.next=3,k.audioExportService.init();case 3:return e.prev=3,e.next=6,k.netmdService.connect();case 6:if(!e.sent){e.next=10;break}return t(z.setState("MAIN")),e.abrupt("return");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0);case 15:return e.prev=15,e.next=18,k.netmdService.pair();case 18:if(!e.sent){e.next=22;break}return t(z.setState("MAIN")),e.abrupt("return");case 22:t(Object(y.batchActions)([z.setPairingMessage("Connection Failed"),z.setPairingFailed(!0)])),e.next=30;break;case 25:e.prev=25,e.t1=e.catch(15),console.error(e.t1),n=e.t1.message,t(Object(y.batchActions)([z.setPairingMessage(n),z.setPairingFailed(!0)]));case 30:case"end":return e.stop()}}),e,null,[[3,12],[15,25]])})));return function(t,a){return e.apply(this,arguments)}}())},className:t.button},"Connect"),r.a.createElement(me.a,{error:!0,className:t.spacing,style:{visibility:l?"visible":"hidden"}},r.a.createElement(fe.a,null,s))):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"This Web browser is not supported.\xa0",r.a.createElement(be.a,{rel:"noopener noreferrer",href:"#",onClick:function(e){e.preventDefault(),b(!0)}},"Learn Why")),r.a.createElement(be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},r.a.createElement("img",{alt:"Chrome Logo",src:Fe.a,className:t.chromeLogo})),r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Try using"," ",r.a.createElement(be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},"Chrome")," ","instead"),d?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"p",variant:"body2",className:t.why},"Web MiniDisc requires a browser that supports both"," ",r.a.createElement(be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://wicg.github.io/webusb/"},"WebUSB")," ","and"," ",r.a.createElement(be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://webassembly.org/"},"WebAssembly"),"."),r.a.createElement("ul",null,r.a.createElement("li",null,"WebUSB is needed to control the NetMD device via the USB connection to your computer."),r.a.createElement("li",null,"WebAssembly is used to convert the music to a MiniDisc compatible format"))):null)),r.a.createElement(xe,null))},Le=a(216),Te=a(3),Ae=a(224),Be=a(14),Ie=a(473),Ve=a(221),Re=a.n(Ve),_e=a(219),Ue=a.n(_e),ze=a(220),Je=a.n(ze),Ge=a(468),He=a(472),Ye=a(471),qe=a(469),Ke=a(470),$e=a(467),Qe=a(478),Xe=a(464),Ze=r.a.forwardRef((function(e,t){return r.a.createElement(Ee.a,Object.assign({direction:"up",ref:t},e))})),et=function(e){var t=Object(o.c)(),a=V((function(e){return e.renameDialog.visible})),n=V((function(e){return e.renameDialog.title})),i=V((function(e){return e.renameDialog.index})),c=function(){t(P.setVisible(!1))},l=function(){t(function(e){var t=e.index,a=e.newName;return(function(){var e=Object(m.a)(p.a.mark((function e(n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=k.netmdService,e.next=3,r.renameTrack(t,a);case 3:n(P.setVisible(!1)),ce()(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}({index:i,newName:n}))};return r.a.createElement(ge.a,{open:a,onClose:c,maxWidth:"sm",fullWidth:!0,TransitionComponent:Ze,"aria-labelledby":"rename-dialog-title"},r.a.createElement(we.a,{id:"rename-dialog-title"},"Rename Track"),r.a.createElement(ve.a,null,r.a.createElement(Xe.a,{autoFocus:!0,id:"name",label:"Track Name",type:"text",fullWidth:!0,value:n,onKeyDown:function(e){"Enter"===e.key&&l()},onChange:function(e){t(P.setCurrentName(e.target.value))}})),r.a.createElement(he.a,null,r.a.createElement(ue.a,{onClick:c},"Cancel"),r.a.createElement(ue.a,{color:"primary",onClick:l},"Rename")))},tt=a(465),at=Object(ee.a)((function(e){return{progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)},uploadLabel:{marginTop:e.spacing(3)}}})),nt=r.a.forwardRef((function(e,t){return r.a.createElement(Ee.a,Object.assign({direction:"up",ref:t},e))})),rt=function(e){var t=at(),a=V((function(e){return e.uploadDialog})),n=a.visible,i=a.writtenProgress,c=a.encryptedProgress,o=a.totalProgress,l=a.trackTotal,s=a.trackCurrent,u=a.trackConverting,p=a.titleCurrent,m=a.titleConverting,f=Math.floor(i/o*100),d=Math.floor(c/o*100),b=Math.floor(u/l*100);return r.a.createElement(ge.a,{open:n,maxWidth:"sm",fullWidth:!0,TransitionComponent:nt,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},r.a.createElement(we.a,{id:"alert-dialog-slide-title"},"Recording..."),r.a.createElement(ve.a,null,r.a.createElement(ke.a,{id:"alert-dialog-slide-description"},100===b&&u===l?"Convertion completed":"Converting ".concat(u+1," of ").concat(l,": ").concat(m)),r.a.createElement(tt.a,{className:t.progressBar,variant:"determinate",color:"primary",value:b}),r.a.createElement(de.a,{className:t.progressPerc},b,"%"),r.a.createElement(ke.a,{id:"alert-dialog-slide-description",className:t.uploadLabel},"Uploading ",s," of ",l,": ",p),r.a.createElement(tt.a,{className:t.progressBar,variant:"buffer",color:"secondary",value:f,valueBuffer:d}),r.a.createElement(de.a,{className:t.progressPerc},f,"%")),r.a.createElement(he.a,null))},it=r.a.forwardRef((function(e,t){return r.a.createElement(Ee.a,Object.assign({direction:"up",ref:t},e))})),ct=function(e){var t=Object(o.c)(),a=V((function(e){return e.errorDialog})),n=a.visible,i=a.error;return r.a.createElement(ge.a,{open:n,maxWidth:"sm",fullWidth:!0,TransitionComponent:it,"aria-labelledby":"error-dialog-slide-title","aria-describedby":"error-dialog-slide-description"},r.a.createElement(we.a,{id:"alert-dialog-slide-title"},"Error"),r.a.createElement(ve.a,null,r.a.createElement(ke.a,{id:"alert-dialog-slide-description"},i)),r.a.createElement(he.a,null,r.a.createElement(ue.a,{onClick:function(){t(M.setVisible(!1))}},"Close")))},ot=a(423),lt=a(421),st=a(419),ut=r.a.forwardRef((function(e,t){return r.a.createElement(Ee.a,Object.assign({direction:"up",ref:t},e))})),pt=Object(ee.a)((function(e){return{container:{display:"flex",flexDirection:"row"},formControl:{minWidth:120}}})),mt=function(e){var t=Object(o.c)(),a=pt(),n=V((function(e){return e.convertDialog})),i=n.visible,c=n.format,l=function(){t(A.setVisible(!1))};return r.a.createElement(ge.a,{open:i,maxWidth:"xs",fullWidth:!0,TransitionComponent:ut,"aria-labelledby":"convert-dialog-slide-title","aria-describedby":"convert-dialog-slide-description"},r.a.createElement(we.a,{id:"convert-dialog-slide-title"},"Upload Settings"),r.a.createElement(ve.a,null,r.a.createElement(me.a,{className:a.formControl},r.a.createElement(ot.a,{color:"secondary",id:"convert-dialog-format"},"Format"),r.a.createElement(lt.a,{labelId:"convert-dialog-format-label",id:"convert-dialog-format",value:c,color:"secondary",onChange:function(e){t(A.setFormat(e.target.value))},input:r.a.createElement(st.a,null)},r.a.createElement(Ce.a,{value:"SP"},"SP"),r.a.createElement(Ce.a,{value:"LP2"},"LP2"),r.a.createElement(Ce.a,{value:"LP4"},"LP4")))),r.a.createElement(he.a,null,r.a.createElement(ue.a,{onClick:l},"Cancel"),r.a.createElement(ue.a,{onClick:function(){l(),t(function(e,t){return function(){var a=Object(m.a)(p.a.mark((function a(n,r){var i,c,o,l,s,u,f,d,b,g,h,v,w,E,x,j,C,N,S,P;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=k.audioExportService,c=k.netmdService,o=oe[t],n(O.setVisible(!0)),l=function(e){var t=e.written,a=e.encrypted,r=e.total;n(O.setWriteProgress({written:t,encrypted:a,total:r}))},s={current:0,converting:0,total:e.length,titleCurrent:"",titleConverting:""},u=function(){n(O.setTrackProgress(s))},f=function(){var e=Object(re.a)(p.a.mark((function e(a){var n,r,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=function(){if(r===a.length)return s.converting=r,s.titleConverting="",void u();var e=a[r];s.converting=r,s.titleConverting=e.name,u(),r++,n.push(new Promise(function(){var a=Object(m.a)(p.a.mark((function a(n,r){var o;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.prepare(e);case 3:return a.next=5,i.export({format:t});case 5:o=a.sent,c(),n({file:e,data:o}),a.next=15;break;case 10:a.prev=10,a.t0=a.catch(0),d=a.t0,b="".concat(e.name,": Unsupported or unrecognized format"),r(a.t0);case 15:case"end":return a.stop()}}),a,null,[[0,10]])})));return function(e,t){return a.apply(this,arguments)}}()))},n=[],r=0,c(),o=0;case 5:if(!(o<n.length)){e.next=11;break}return e.next=8,n[o];case 8:o++,e.next=5;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b="",g=1,h=!0,v=!1,a.prev=11,E=Object(ie.a)(f(e));case 13:return a.next=15,E.next();case 15:return x=a.sent,h=x.done,a.next=19,x.value;case 19:if(j=a.sent,h){a.next=40;break}return N=(C=j).file,S=C.data,s.current=g++,s.titleCurrent=N.name,u(),l({written:0,encrypted:0,total:100}),a.prev=27,a.next=30,null===c||void 0===c?void 0:c.upload(N.name,S,o,l);case 30:a.next=37;break;case 32:return a.prev=32,a.t0=a.catch(27),d=a.t0,b="".concat(N.name,": Error uploading to device"),a.abrupt("break",40);case 37:h=!0,a.next=13;break;case 40:a.next=46;break;case 42:a.prev=42,a.t1=a.catch(11),v=!0,w=a.t1;case 46:if(a.prev=46,a.prev=47,h||null==E.return){a.next=51;break}return a.next=51,E.return();case 51:if(a.prev=51,!v){a.next=54;break}throw w;case 54:return a.finish(51);case 55:return a.finish(46);case 56:P=[O.setVisible(!1)],d&&(console.error(d),P=P.concat([M.setVisible(!0),M.setErrorMessage(b)])),n(Object(y.batchActions)(P)),ce()(n);case 60:case"end":return a.stop()}}),a,null,[[11,42,46,56],[27,32],[47,,51,55]])})));return function(e,t){return a.apply(this,arguments)}}()}(e.files,c))}},"Ok")))},ft=a(477),dt=a(142),bt=Object(ee.a)((function(e){return{add:{position:"absolute",bottom:e.spacing(3),right:e.spacing(3)},main:{overflowY:"auto",flex:"1 1 auto",marginBottom:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2),outline:"none"},toolbar:Object($.a)({marginTop:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2)},e.breakpoints.up(600+2*e.spacing(2)),{marginLeft:e.spacing(-3),marginRight:e.spacing(-3)}),toolbarLabel:{flex:"1 1 100%"},toolbarHighlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Be.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},headBox:{display:"flex",justifyContent:"space-between"},spacing:{marginTop:e.spacing(1)},formatBadge:Object(Le.a)({},dt.styles(e).badge,{},dt.styles(e).colorPrimary,{position:"static",display:"inline-flex",border:"2px solid ".concat(e.palette.background.paper),padding:"0 4px"}),titleCell:{overflow:"hidden",maxWidth:"40ch",textOverflow:"ellipsis"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),gt=(le={},Object($.a)(le,b.Encoding.sp,"SP"),Object($.a)(le,b.Encoding.lp2,"LP2"),Object($.a)(le,b.Encoding.lp4,"LP4"),le),ht=function(e){var t=Object(o.c)(),a=V((function(e){return e.main.disc})),i=V((function(e){return e.main.deviceName})),c=r.a.useState([]),l=Object(ne.a)(c,2),s=l[0],u=l[1],f=s.length;Object(n.useEffect)((function(){t(ce())}),[t]),Object(n.useEffect)((function(){u([])}),[a]);var d=r.a.useState([]),g=Object(ne.a)(d,2),h=g[0],v=g[1],E=Object(n.useCallback)((function(e,a){v(e),t(A.setVisible(!0))}),[t]),x=Object(Ae.a)({onDrop:E,accept:"audio/*",noClick:!0}),j=x.getRootProps,O=x.getInputProps,C=x.isDragActive,N=x.open,S=bt(),D=[];if(null!==a){var F=!0,M=!1,W=void 0;try{for(var L,T=a.groups[Symbol.iterator]();!(F=(L=T.next()).done);F=!0){var B=L.value,I=!0,R=!1,_=void 0;try{for(var U,J=B.tracks[Symbol.iterator]();!(I=(U=J.next()).done);I=!0){var G,H,Y=U.value;D.push({index:Y.index,title:null!==(G=Y.title)&&void 0!==G?G:"Unknown Title",group:null!==(H=B.title)&&void 0!==H?H:"",encoding:gt[Y.encoding],duration:Object(b.formatTimeFromFrames)(Y.duration,!1)})}}catch(K){R=!0,_=K}finally{try{I||null==J.return||J.return()}finally{if(R)throw _}}}}catch(K){M=!0,W=K}finally{try{F||null==T.return||T.return()}finally{if(M)throw W}}}var q=function(e,n){var r,i,c=n,o=null!==(r=null===(i=Object(b.getTracks)(a).find((function(e){return e.index===c})))||void 0===i?void 0:i.title)&&void 0!==r?r:"";t(Object(y.batchActions)([P.setVisible(!0),P.setCurrentName(o),P.setIndex(c)]))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(de.a,{className:S.headBox},r.a.createElement(pe.a,{component:"h1",variant:"h4"},i||"Loading..."),r.a.createElement(Pe,null)),r.a.createElement(pe.a,{component:"h2",variant:"body2"},null!==a?"".concat(Object(b.formatTimeFromFrames)(a.left,!1)," left of ").concat(Object(b.formatTimeFromFrames)(a.total,!1)):"Loading..."),r.a.createElement($e.a,{className:Object(Te.default)(S.toolbar,Object($.a)({},S.toolbarHighlight,f>0))},f>0?r.a.createElement(ft.a,{indeterminate:f>0&&f<D.length,checked:f>0,onChange:function(e){s.length<D.length?u(D.map((function(e){return e.index}))):u([])},inputProps:{"aria-label":"select all tracks"}}):null,f>0?r.a.createElement(pe.a,{className:S.toolbarLabel,color:"inherit",variant:"subtitle1"},f," selected"):r.a.createElement(pe.a,{component:"h3",variant:"h6",className:S.toolbarLabel},"Content"),f>0?r.a.createElement(Qe.a,{title:"Delete"},r.a.createElement(je.a,{"aria-label":"delete",onClick:function(e){var a;t((a=s,function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,i,c,o,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=k.netmdService,t(z.setLoading(!0)),(a=a.sort()).reverse(),r=!0,i=!1,c=void 0,e.prev=7,o=a[Symbol.iterator]();case 9:if(r=(l=o.next()).done){e.next=16;break}return s=l.value,e.next=13,n.deleteTrack(s);case 13:r=!0,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),i=!0,c=e.t0;case 22:e.prev=22,e.prev=23,r||null==o.return||o.return();case 25:if(e.prev=25,!i){e.next=28;break}throw c;case 28:return e.finish(25);case 29:return e.finish(22);case 30:ce()(t);case 31:case"end":return e.stop()}}),e,null,[[7,18,22,30],[23,,25,29]])})));return function(t){return e.apply(this,arguments)}}()))}},r.a.createElement(Ue.a,null))):null,f>0?r.a.createElement(Qe.a,{title:"Rename"},r.a.createElement(je.a,{"aria-label":"rename",disabled:1!==f,onClick:function(e){q(0,s[0])}},r.a.createElement(Je.a,null))):null),r.a.createElement(de.a,Object.assign({className:S.main},j()),r.a.createElement("input",O()),r.a.createElement(Ge.a,{size:"small"},r.a.createElement(qe.a,null,r.a.createElement(Ke.a,null,r.a.createElement(Ye.a,null,"Title"),r.a.createElement(Ye.a,null,"Format"),r.a.createElement(Ye.a,{align:"right"},"Duration"))),r.a.createElement(He.a,null,D.map((function(e){return r.a.createElement(Ke.a,{hover:!0,selected:s.includes(e.index),key:e.index,onDoubleClick:function(t){return q(0,e.index)},onClick:function(t){return a=e.index,void(s.includes(a)?u(s.filter((function(e){return e!==a}))):u([].concat(Object(w.a)(s),[a])));var a}},r.a.createElement(Ye.a,{className:S.titleCell,title:e.title},e.title||"No Title"),r.a.createElement(Ye.a,null,r.a.createElement("span",{className:S.formatBadge},e.encoding)),r.a.createElement(Ye.a,{align:"right"},e.duration))})))),r.a.createElement(X.a,{className:S.backdrop,open:C},"Drop your Music to Upload")),r.a.createElement(Ie.a,{color:"primary","aria-label":"add",className:S.add,onClick:N},r.a.createElement(Re.a,null)),r.a.createElement(rt,null),r.a.createElement(et,null),r.a.createElement(ct,null),r.a.createElement(mt,{files:h}),r.a.createElement(xe,null))},vt=a(412),kt=a(222),wt=a.n(kt),Et=Object(ee.a)((function(e){return{layout:Object($.a)({width:"auto",height:"100%"},e.breakpoints.up(600+2*e.spacing(2)),{width:600,marginLeft:"auto",marginRight:"auto"}),paper:Object($.a)({position:"relative",display:"flex",flexDirection:"column",padding:e.spacing(2),height:"100%"},e.breakpoints.up(600+2*e.spacing(2)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3),height:600}),copyright:{display:"flex",alignItems:"center"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},minidiscLogo:{width:48}}})),yt=Object(te.a)({palette:{type:"dark",primary:{light:"#6ec6ff",main:"#2196f3",dark:"#0069c0",contrastText:"#fff"}}}),xt=Object(te.a)({palette:{type:"light"}}),jt=function(){var e=Et(),t=Object(o.c)(),a=V((function(e){return e.appState})),n=a.mainView,i=a.loading,c=a.darkMode;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{theme:c?yt:xt},r.a.createElement(Q.a,null),r.a.createElement("main",{className:e.layout},r.a.createElement(vt.a,{className:e.paper},"WELCOME"===n?r.a.createElement(We,null):null,"MAIN"===n?r.a.createElement(ht,null):null,r.a.createElement(de.a,{className:e.copyright},r.a.createElement(je.a,{onClick:function(){return t(z.setDarkMode(!c))}},r.a.createElement(wt.a,{color:c?"secondary":void 0})),r.a.createElement(pe.a,{variant:"body2",color:"textSecondary",style:{marginRight:"8px"}},"\xa9 ",r.a.createElement(be.a,{rel:"noopener noreferrer",color:"inherit",target:"_blank",href:"https://stefano.brilli.me/"},"Stefano Brilli")," ",(new Date).getFullYear(),"."),r.a.createElement(be.a,{rel:"noopener noreferrer",href:"https://twitter.com/share?ref_src=twsrc%5Etfw",className:"twitter-share-button","data-via":"thecybercase","data-hashtags":"MiniDisc","data-dnt":"true","data-show-count":"false"},"Tweet"),r.a.createElement(de.a,{style:{flex:"1 1 auto"}})))),r.a.createElement(X.a,{className:e.backdrop,open:i},r.a.createElement(Z.a,{color:"inherit"}))))},Ot=(a(391),a(143)),Ct=a(2),Nt=function(){function e(t){Object(f.a)(this,e),this.worker=t,this.messageCallback=void 0,t.onmessage=this.handleMessage.bind(this)}return Object(d.a)(e,[{key:"init",value:function(){var e=Object(m.a)(p.a.mark((function e(){var t=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.messageCallback=e,t.worker.postMessage({action:"init"})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"encode",value:function(){var e=Object(m.a)(p.a.mark((function e(t,a){var n,r=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){r.messageCallback=e,r.worker.postMessage({action:"encode",bitrate:a,data:t},[t])}));case 2:return n=e.sent,e.abrupt("return",n.data.result);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleMessage",value:function(e){this.messageCallback(e),this.messageCallback=void 0}}]),e}();"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&(onmessage=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n,r,i,c,o,l,s,u,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.data,n=a.action,r=Object(Ct.a)(a,["action"]),"init"===n?(self.importScripts("atracdenc.js"),self.Module().then((function(e){se=e,self.postMessage({action:"init"})}))):"encode"===n&&(i=r.bitrate,c=r.data,"inWavFile.wav","outAt3File.aea",se.FS.writeFile("".concat("inWavFile.wav"),new Uint8Array(c)),se.callMain(["-e","atrac3","-i","inWavFile.wav","-o","outAt3File.aea","--bitrate",i]),o=se.FS.stat("outAt3File.aea"),l=o.size,s=new Uint8Array(l-96),u=se.FS.open("outAt3File.aea","r"),se.FS.read(u,s,0,s.length,96),se.FS.close(u),m=s.buffer,self.postMessage({action:"encode",result:m},[m]),self.close());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var St=a(410),Pt=function(){function e(){Object(f.a)(this,e),this.ffmpegProcess=void 0,this.atracdencProcess=void 0,this.loglines=[],this.inFileName="",this.outFileNameNoExt=""}return Object(d.a)(e,[{key:"init",value:function(){var e=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(Ot.setLogging)(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"prepare",value:function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loglines=[],this.ffmpegProcess=Object(Ot.createWorker)({logger:function(e){n.loglines.push(e),console.log(e.action,e.message)},corePath:"/ffmpeg-core.js",workerPath:"/worker.dev.js"}),e.next=4,this.ffmpegProcess.load();case 4:return this.atracdencProcess=new Nt(new St),e.next=7,this.atracdencProcess.init();case 7:if(0!==(a=t.name.split(".").slice(-1)).length){e.next=10;break}throw new Error("Unrecognized file format: ".concat(t.name));case 10:return this.inFileName="inAudioFile.".concat(a[0]),this.outFileNameNoExt="outAudioFile",e.next=14,this.ffmpegProcess.write(this.inFileName,t);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"info",value:function(){var e=Object(m.a)(p.a.mark((function e(){var t,a,n,r,i,c,o,l,s,u,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ffmpegProcess.transcode(this.inFileName,"".concat(this.outFileNameNoExt,".metadata"),"-f ffmetadata");case 2:t=/Audio:\s(.*?),/,a=/Input #0,\s(.*?),/,n=null,r=null,i=!0,c=!1,o=void 0,e.prev=9,l=this.loglines[Symbol.iterator]();case 11:if(i=(s=l.next()).done){e.next=26;break}if(u=s.value,null===(m=u.message.match(t))){e.next=17;break}return n=m[1],e.abrupt("continue",23);case 17:if(null===(m=u.message.match(a))){e.next=21;break}return r=m[1],e.abrupt("continue",23);case 21:if(null===n||null===r){e.next=23;break}return e.abrupt("break",26);case 23:i=!0,e.next=11;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(9),c=!0,o=e.t0;case 32:e.prev=32,e.prev=33,i||null==l.return||l.return();case 35:if(e.prev=35,!c){e.next=38;break}throw o;case 38:return e.finish(35);case 39:return e.finish(32);case 40:return e.abrupt("return",{format:n,input:r});case 41:case"end":return e.stop()}}),e,this,[[9,28,32,40],[33,,35,39]])})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n,r,i,c,o,l,s,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("SP"!==(a=t.format)){e.next=12;break}return n="".concat(this.outFileNameNoExt,".raw"),e.next=5,this.ffmpegProcess.transcode(this.inFileName,n,"-f s16be");case 5:return e.next=7,this.ffmpegProcess.read(n);case 7:return r=e.sent,i=r.data,e.abrupt("return",i.buffer);case 12:return c="".concat(this.outFileNameNoExt,".wav"),e.next=15,this.ffmpegProcess.transcode(this.inFileName,c,"-f wav");case 15:return e.next=17,this.ffmpegProcess.read(c);case 17:o=e.sent,l=o.data,s="0",e.t0=a,e.next="LP2"===e.t0?23:"LP105"===e.t0?25:"LP4"===e.t0?27:29;break;case 23:return s="128",e.abrupt("break",29);case 25:return s="102",e.abrupt("break",29);case 27:return s="64",e.abrupt("break",29);case 29:return e.next=31,this.atracdencProcess.encode(l.buffer,s);case 31:return u=e.sent,e.abrupt("return",u);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();k.netmdService=new v,k.audioExportService=new Pt,window.addEventListener("beforeunload",(function(e){K.getState().uploadDialog.visible&&(e.preventDefault(),e.returnValue="Warning! Recording will be interrupted")})),navigator&&navigator.usb?navigator.usb.ondisconnect=function(){K.dispatch(z.setState("WELCOME"))}:K.dispatch(z.setBrowserSupported(!1)),window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault()})),c.a.render(r.a.createElement(o.a,{store:K},r.a.createElement(jt,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/webminidisc",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/webminidisc","/service-worker.js");l?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):s(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):s(t,e)}))}}()}},[[241,1,2]]]);
//# sourceMappingURL=main.a921304d.chunk.js.map